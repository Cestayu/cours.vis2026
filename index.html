<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cinema | Premium Box Office Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Limelight&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      background: radial-gradient(circle at center, #111 0%, #000 70%);
      color: #f5d76e;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-bottom: 60px;
    }

    .lamp {
      position: absolute; top: 40px; width: 40px; height: 40px;
      background: radial-gradient(circle, #ffd27d 0%, #ff9f1c 40%, #cc6b00 70%);
      border-radius: 50%;
      box-shadow: 0 0 30px rgba(255, 160, 60, 0.9), 0 0 80px rgba(255, 120, 0.6);
      z-index: 1;
    }
    .lamp.left { left: 80px; } .lamp.right { right: 80px; }

    h1 {
      margin-top: 60px;
      font-family: 'Limelight', cursive;
      font-size: 80px;
      text-transform: uppercase;
      color: #f7c873;
      text-shadow: 0 0 10px rgba(255, 180, 80, 0.6);
    }

    .research-panel {
      width: 90%; max-width: 1000px;
      display: flex; gap: 15px; margin-bottom: 30px;
      background: rgba(255, 215, 120, 0.05);
      padding: 20px; border-radius: 15px;
      border: 1px solid rgba(247, 200, 115, 0.2);
    }
    .research-panel select, .research-panel input {
      flex: 1; padding: 12px; border-radius: 8px;
      background: #000; color: #f7c873; border: 1px solid #f7c873;
    }

    #boxoffice-viz, #trends-viz {
      width: 90%; max-width: 1000px;
      background: rgba(0,0,0,0.6);
      border: 1px solid rgba(255, 215, 120, 0.3);
      border-radius: 20px; padding: 30px; margin-top: 20px;
    }

    .slider-container { text-align: center; margin-bottom: 25px; }
    .year-display { font-size: 54px; font-family: 'Limelight'; color: #f7c873; margin-bottom: 10px; }
    
    .films-panel { display: grid; grid-template-columns: 1fr; gap: 15px; }
    .film {
      display: flex; align-items: center; padding: 12px;
      border: 1px solid rgba(255, 215, 120, 0.2);
      border-radius: 14px; background: rgba(0,0,0,0.4);
    }
    .poster { width: 80px; height: 120px; border-radius: 8px; margin-right: 20px; background-size: cover; background-position: center; }
    .film-title { font-size: 20px; font-weight: bold; color: #f7c873; }

    .btn-play-trend {
      background: #f7c873; color: #000; border: none; padding: 10px 25px;
      border-radius: 50px; font-weight: bold; cursor: pointer; margin-bottom: 20px;
      transition: transform 0.2s;
    }
    .btn-play-trend:hover { transform: scale(1.05); }

    .trends-grid { display: grid; grid-template-columns: 1fr 280px; gap: 30px; align-items: center; }
    .spotlight-mini { text-align: center; border-left: 1px solid rgba(255,215,120,0.2); padding-left: 20px; }
    .covid-note { color: #ff4d4d; font-weight: bold; font-size: 14px; margin-top: 10px; display: none; }
  </style>
</head>
<body>

  <div class="lamp left"></div>
  <div class="lamp right"></div>

  <h1>Cinema</h1>

  <div class="research-panel">
    <select id="res-genre">
      <option value="All">All Genres</option>
      <option value="Action">Action</option>
      <option value="Animation">Animation</option>
      <option value="Science-fiction">Science-fiction</option>
      <option value="Fantasy">Fantasy</option>
      <option value="Guerre">War</option>
      <option value="Comédie">Comedy</option>
    </select>
    <input type="text" id="res-director" placeholder="Filter by Director Name...">
  </div>

  <section id="boxoffice-viz">
    <div class="slider-container">
      <div class="year-display" id="boxoffice-year">2013</div>
      <input type="range" min="2013" max="2023" step="1" value="2013" id="boxoffice-slider" style="width: 100%;">
    </div>
    <div class="films-panel" id="boxoffice-films"></div>
  </section>

  <section id="trends-viz">
    <h2 style="font-family: 'Limelight'; text-align: center; margin-bottom: 10px;">Yearly Trends Evolution</h2>
    <div style="text-align: center;">
        <button class="btn-play-trend" id="trend-play-btn">▶ Play Evolution</button>
    </div>
    <div class="trends-grid">
      <div>
        <canvas id="trendChart"></canvas>
      </div>
      <div class="spotlight-mini">
        <div style="font-size: 12px; opacity: 0.6; letter-spacing: 1px;">TOP FILM IN <span id="trend-year-label">2013</span></div>
        <img id="trend-poster" style="width: 150px; border-radius: 8px; margin: 15px 0; border: 2px solid #f7c873; box-shadow: 0 10px 20px rgba(0,0,0,0.5);">
        <div id="trend-title" style="font-weight: bold; font-size: 18px; color: #f7c873;">Title</div>
        <div id="covid-alert" class="covid-note">⚠️ COVID-19 IMPACT:<br>GLOBAL THEATERS CLOSED</div>
      </div>
    </div>
  </section>

  <script>
    const enrichedData = [
      {"year":2013,"rank":1,"title":"Frozen","boxOffice":"1280802282","genre":"Animation","country":"États-Unis","director":"Chris Buck, Jennifer Lee","directorGender":"Homme / Femme","poster":"https://image.tmdb.org/t/p/w500/kgwjIb1CkFCftymFGOtdLlOrWYv.jpg"},
      {"year":2013,"rank":2,"title":"Iron Man 3","boxOffice":"1214811252","genre":"Action / Super-héros","country":"États-Unis","director":"Shane Black","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/qhPtAc1TKbMPqNvcdXSOn9Bn7hZ.jpg"},
      {"year":2013,"rank":3,"title":"Despicable Me 2","boxOffice":"970766005","genre":"Animation","country":"États-Unis","director":"Pierre Coffin, Chris Renaud","directorGender":"Hommes","poster":"https://image.tmdb.org/t/p/w500/5Fh4NdoEnCjCK9wLjdJ9DJNFl2b.jpg"},
      {"year":2013,"rank":4,"title":"The Hobbit: The Desolation of Smaug","boxOffice":"958366855","genre":"Fantasy","country":"Nouvelle-Zélande / États-Unis","director":"Peter Jackson","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/xQYiXsmeYkKMq5yvwD0ejl8cWs7.jpg"},
      {"year":2013,"rank":5,"title":"The Hunger Games: Catching Fire","boxOffice":"865011746","genre":"Science-fiction","country":"États-Unis","director":"Francis Lawrence","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/v9qVkyS58WHdfrcEq0dxUJFKS9n.jpg"},
      {"year":2014,"rank":1,"title":"Transformers: Age of Extinction","boxOffice":"1104054072","genre":"Action / Science-fiction","country":"États-Unis","director":"Michael Bay","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/jyzrfx2WaeY60kYZpPYepSjGz4S.jpg"},
      {"year":2014,"rank":2,"title":"The Hobbit: The Battle of the Five Armies","boxOffice":"962201338","genre":"Fantasy","country":"Nouvelle-Zélande / États-Unis","director":"Peter Jackson","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/9zd9P2J3N7A4hBgx1RGCFgTMBPk.jpg"},
      {"year":2014,"rank":3,"title":"Guardians of the Galaxy","boxOffice":"773350147","genre":"Action / Science-fiction","country":"États-Unis","director":"James Gunn","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/r7vmZjiyZw9rpJMQJdXpjgiCOk9.jpg"},
      {"year":2014,"rank":4,"title":"Maleficent","boxOffice":"758536735","genre":"Fantasy","country":"États-Unis","director":"Robert Stromberg","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/bDG3yei6AJlEAK3A5wN7RwFXQ7V.jpg"},
      {"year":2014,"rank":5,"title":"The Hunger Games: Mockingjay – Part 1","boxOffice":"755356711","genre":"Science-fiction","country":"États-Unis","director":"Francis Lawrence","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/4PwyB0ErucIANzW24Kori71J6gU.jpg"},
      {"year":2015,"rank":1,"title":"Star Wars: The Force Awakens","boxOffice":"2068223624","genre":"Science-fiction","country":"États-Unis","director":"J. J. Abrams","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/wqnLdwVXoBjKibFRR5U3y0aDUhs.jpg"},
      {"year":2015,"rank":2,"title":"Jurassic World","boxOffice":"1671537444","genre":"Science-fiction","country":"États-Unis","director":"Colin Trevorrow","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/jIlQHSUc1NnqhbWtkkdIrYLiNl7.jpg"},
      {"year":2015,"rank":3,"title":"Furious 7","boxOffice":"1515341399","genre":"Action","country":"États-Unis","director":"James Wan","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/dCgm7efXDmiABSdWDHBDBx2jwmn.jpg"},
      {"year":2015,"rank":4,"title":"Avengers: Age of Ultron","boxOffice":"1402809540","genre":"Action / Super-héros","country":"États-Unis","director":"Joss Whedon","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/4ssDuvEDkSArWEdyBl2X5EHvYKU.jpg"},
      {"year":2015,"rank":5,"title":"Minions","boxOffice":"1159444662","genre":"Animation","country":"États-Unis","director":"Pierre Coffin, Kyle Balda","directorGender":"Hommes","poster":"https://image.tmdb.org/t/p/w500/dr02BdCNAUPVU07aOodwPYv6HCf.jpg"},
      {"year":2016,"rank":1,"title":"Captain America: Civil War","boxOffice":"1153337496","genre":"Action / Super-héros","country":"États-Unis","director":"Anthony & Joe Russo","directorGender":"Hommes","poster":"https://image.tmdb.org/t/p/w500/rAGiXaUfPu0D2BJ1JMQzJiD8tFl.jpg"},
      {"year":2016,"rank":2,"title":"Rogue One: A Star Wars Story","boxOffice":"1056057273","genre":"Science-fiction","country":"États-Unis","director":"Gareth Edwards","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/i0yw1mFbB7sNGHCs7EXZPzFkdA1.jpg"},
      {"year":2016,"rank":3,"title":"Finding Dory","boxOffice":"1028570889","genre":"Animation","country":"États-Unis","director":"Andrew Stanton","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/yFjVlsJmEMacU0BNUwdGZlo2ixq.jpg"},
      {"year":2016,"rank":4,"title":"Zootopia","boxOffice":"1025521689","genre":"Animation","country":"États-Unis","director":"Byron Howard, Rich Moore","directorGender":"Hommes","poster":"https://image.tmdb.org/t/p/w500/hlK0e0wAQ3VLuJcsfIYPvb4JVud.jpg"},
      {"year":2016,"rank":5,"title":"The Jungle Book","boxOffice":"967724775","genre":"Aventure / Fantasy","country":"États-Unis","director":"Jon Favreau","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/vOipe2myi26UDwP978hsYOrnUWC.jpg"},
      {"year":2017,"rank":1,"title":"Star Wars: The Last Jedi","boxOffice":"1334407706","genre":"Science-fiction","country":"États-Unis","director":"Rian Johnson","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/kOVEVeg59E0wsnXmF9nrh6OmWII.jpg"},
      {"year":2017,"rank":2,"title":"Beauty and the Beast","boxOffice":"1266115964","genre":"Fantasy","country":"États-Unis","director":"Bill Condon","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/hKegSKIDep2ewJWPUQD7u0KqFIp.jpg"},
      {"year":2017,"rank":3,"title":"The Fate of the Furious","boxOffice":"1236005118","genre":"Action","country":"États-Unis","director":"F. Gary Gray","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/dImWM7GJqryWJO9LHa3XQ8DD5NH.jpg"},
      {"year":2017,"rank":4,"title":"Despicable Me 3","boxOffice":"1034800131","genre":"Animation","country":"États-Unis","director":"Kyle Balda","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/6t3YWl7hrr88lCEFlGVqW5yV99R.jpg"},
      {"year":2017,"rank":5,"title":"Jumanji: Welcome to the Jungle","boxOffice":"962102237","genre":"Aventure","country":"États-Unis","director":"Jake Kasdan","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/bXrZ5iHBEjH7WMidbUDQ0U2xbmr.jpg"},
      {"year":2018,"rank":1,"title":"Avengers: Infinity War","boxOffice":"2048359754","genre":"Action / Super-héros","country":"États-Unis","director":"Anthony & Joe Russo","directorGender":"Hommes","poster":"https://image.tmdb.org/t/p/w500/7WsyChQLEftFiDOVTGkv3hFpyyt.jpg"},
      {"year":2018,"rank":2,"title":"Black Panther","boxOffice":"1347597973","genre":"Action / Super-héros","country":"États-Unis","director":"Ryan Coogler","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/uxzzxijgPIY7slzFvMotPv8wjKA.jpg"},
      {"year":2018,"rank":3,"title":"Jurassic World: Fallen Kingdom","boxOffice":"1308467944","genre":"Science-fiction","country":"États-Unis","director":"J. A. Bayona","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/c9XxwwhPHdaImA2f1WEfEsbhaFB.jpg"},
      {"year":2018,"rank":4,"title":"Incredibles 2","boxOffice":"1242805359","genre":"Animation","country":"États-Unis","director":"Brad Bird","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/9lFKBtaVIhP7E2Pk0IY1CwTKTMZ.jpg"},
      {"year":2018,"rank":5,"title":"Aquaman","boxOffice":"1148528393","genre":"Action / Super-héros","country":"États-Unis","director":"James Wan","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/5Kg76ldv7VxeX9YlcQXiowHgdX6.jpg"},
      {"year":2019,"rank":1,"title":"Avengers: Endgame","boxOffice":"2797501328","genre":"Action / Super-héros","country":"États-Unis","director":"Anthony & Joe Russo","directorGender":"Hommes","poster":"https://image.tmdb.org/t/p/w500/or06FN3Dka5tukK1e9sl16pB3iy.jpg"},
      {"year":2020,"rank":1,"title":"The Eight Hundred","boxOffice":"461421559","genre":"Guerre","country":"Chine","director":"Guan Hu","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/pk4GFAALvJhckzPY5h3L1RkfSD6.jpg"},
      {"year":2021,"rank":1,"title":"Spider-Man: No Way Home","boxOffice":"1921847111","genre":"Action / Super-héros","country":"États-Unis","director":"Jon Watts","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/1g0dhYtq4irTY1GPXvft6k4YLjm.jpg"},
      {"year":2022,"rank":1,"title":"Avatar: The Way of Water","boxOffice":"2320250281","genre":"Science-fiction","country":"États-Unis","director":"James Cameron","directorGender":"Homme","poster":"https://image.tmdb.org/t/p/w500/t6HIqrRAclMCA60NsSmeqe9RmNV.jpg"},
      {"year":2023,"rank":1,"title":"Barbie","boxOffice":"1445638421","genre":"Comédie / Fantasy","country":"États-Unis","director":"Greta Gerwig","directorGender":"Femme","poster":"https://image.tmdb.org/t/p/w500/iuFNMS8U5cb6xfzi51Dbkovj7vM.jpg"}
    ];

    const slider = document.getElementById("boxoffice-slider");
    const yearDisplay = document.getElementById("boxoffice-year");
    const filmsContainer = document.getElementById("boxoffice-films");
    const trendYearLabel = document.getElementById("trend-year-label");
    const trendPlayBtn = document.getElementById("trend-play-btn");

    let trendChart;
    let trendYear = 2013;
    let trendInterval;
    let isTrendPlaying = false;

    // UPDATE TOP 5 (MANUAL)
    function updateTopFive() {
      const year = slider.value;
      const genre = document.getElementById("res-genre").value;
      const director = document.getElementById("res-director").value.toLowerCase();
      
      yearDisplay.textContent = year;
      filmsContainer.innerHTML = "";

      const films = enrichedData.filter(d => 
        d.year == year && 
        (genre === "All" || d.genre.includes(genre)) &&
        d.director.toLowerCase().includes(director)
      ).sort((a,b) => a.rank - b.rank).slice(0,5);

      films.forEach(f => {
        filmsContainer.innerHTML += `
          <div class="film">
            <div class="poster" style="background-image:url('${f.poster}')"></div>
            <div>
              <div class="film-title">#${f.rank} ${f.title}</div>
              <div style="opacity:0.8; font-size:14px;">${f.genre} | ${f.director}</div>
              <div style="color: #f7c873; font-weight: bold; margin-top: 5px;">$${(parseInt(f.boxOffice)/1e6).toFixed(1)}M</div>
            </div>
          </div>
        `;
      });
    }

    // UPDATE TREND SECTION (ANIMATED)
    function updateTrendSection(year) {
      trendYearLabel.textContent = year;
      const top1 = enrichedData.find(d => d.year == year && d.rank == 1);
      
      if(top1) {
        document.getElementById("trend-poster").src = top1.poster;
        document.getElementById("trend-title").textContent = top1.title;
      }

      document.getElementById("covid-alert").style.display = (year == 2020) ? "block" : "none";
      
      // Highlight chart point
      trendChart.setActiveElements([{datasetIndex: 0, index: year - 2013}]);
      trendChart.update();
    }

    // TREND ANIMATION LOGIC
    trendPlayBtn.onclick = () => {
      isTrendPlaying = !isTrendPlaying;
      trendPlayBtn.textContent = isTrendPlaying ? "⏸ Pause Evolution" : "▶ Play Evolution";
      
      if(isTrendPlaying) {
        trendInterval = setInterval(() => {
          trendYear = (trendYear >= 2023) ? 2013 : trendYear + 1;
          updateTrendSection(trendYear);
        }, 1200);
      } else {
        clearInterval(trendInterval);
      }
    };

    // INIT CHART
    function initChart() {
      const years = [2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023];
      // Hardcoded sample totals for display
      const dataPoints = [4.5, 4.3, 7.8, 5.2, 5.8, 7.1, 8.2, 1.9, 5.1, 6.7, 5.3];

      trendChart = new Chart(document.getElementById('trendChart'), {
        type: 'line',
        data: {
          labels: years,
          datasets: [{
            data: dataPoints,
            borderColor: '#f7c873',
            backgroundColor: 'rgba(247, 200, 115, 0.1)',
            fill: true,
            tension: 0.4,
            pointRadius: 6,
            pointHoverRadius: 10
          }]
        },
        options: {
          plugins: { legend: { display: false } },
          scales: {
            y: { ticks: { color: '#f7c873' }, grid: { color: 'rgba(255,255,255,0.1)' } },
            x: { ticks: { color: '#f7c873' }, grid: { display: false } }
          }
        }
      });
    }

    // EVENT LISTENERS
    slider.oninput = updateTopFive;
    document.getElementById("res-genre").onchange = updateTopFive;
    document.getElementById("res-director").oninput = updateTopFive;

    // START
    initChart();
    updateTopFive();
    updateTrendSection(2013);
  </script>
</body>
</html>
