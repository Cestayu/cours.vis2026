<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cinema Box Office Master 2013-2023</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
    :root {
        --bg: #ffffff; --text: #0f172a; --muted: #64748b; --accent: #2563eb;
        --male: #3b82f6; --female: #ec4899; --mixed: #a855f7;
        
        /* FIXED: Distinct Colors for all 8 Genres */
        --c-action: #ef4444;      /* Red */
        --c-animation: #f97316;   /* Orange */
        --c-fantasy: #d946ef;     /* Fuchsia (Distinct from Drama) */
        --c-scifi: #10b981;       /* Emerald */
        --c-comedy: #eab308;      /* Yellow/Gold */
        --c-adventure: #06b6d4;   /* Cyan */
        --c-drama: #4f46e5;       /* Indigo (Distinct from Fantasy) */
        --c-war: #475569;         /* Slate */
    }

    * { margin:0; padding:0; box-sizing:border-box; font-family: 'Inter', sans-serif; }
    body { background: var(--bg); color: var(--text); padding: 0 20px; overflow-x: hidden; }
    
    header { display: flex; flex-direction: column; align-items: center; text-align: center; padding: 60px 0 40px; position: relative; }
    h1 { font-size: 3rem; font-weight: 800; letter-spacing: -0.05em; margin-bottom: 8px; color: var(--text); }
    .subtitle { color: var(--muted); font-size: 1.1rem; max-width: 650px; line-height: 1.5; }
    
    .lang-toggle { 
        position: fixed; top: 20px; right: 20px; cursor: pointer; z-index: 100;
        padding: 10px 20px; border: 1px solid #e2e8f0; border-radius: 99px;
        font-weight: 700; font-size: 0.85rem; background: rgba(255,255,255,0.95); 
        box-shadow: 0 4px 12px rgba(0,0,0,0.05); transition: 0.2s;
    }
    .lang-toggle:hover { transform: scale(1.05); }

    nav { display: flex; justify-content: center; gap: 30px; margin-bottom: 50px; border-bottom: 1px solid #f1f5f9; }
    .nav-item { padding: 15px 10px; cursor: pointer; color: var(--muted); font-weight: 500; position: relative; font-size: 0.95rem; transition: 0.3s; }
    .nav-item:hover { color: var(--text); }
    .nav-item.active { color: var(--accent); font-weight: 700; }
    .nav-item.active::after { content:''; position:absolute; bottom:0; left:0; width:100%; height:3px; background: var(--accent); border-radius: 3px 3px 0 0; }

    #stage { max-width: 1200px; margin: 0 auto; min-height: 600px; position: relative; }
    
    /* Legend Styles */
    .legend { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-top: 40px; padding: 25px; background: #f8fafc; border-radius: 16px; border: 1px solid #f1f5f9; }
    .legend-item { display: flex; align-items: center; font-size: 0.85rem; font-weight: 600; color: var(--muted); }
    .legend-dot { width: 12px; height: 12px; border-radius: 50%; margin-right: 8px; }

    /* Gallery Styles */
    .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 30px; padding-bottom: 60px; }
    .movie-card { cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; }
    .movie-card:hover { transform: translateY(-12px); }
    .poster-wrap { 
        aspect-ratio: 2/3; border-radius: 14px; overflow: hidden; background: #e2e8f0; 
        box-shadow: 0 10px 25px rgba(0,0,0,0.1); margin-bottom: 15px; position: relative;
    }
    .poster-wrap img { width:100%; height:100%; object-fit: cover; transition: 0.4s; }
    .movie-card:hover img { transform: scale(1.05); }
    .rank-tag {
        position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.75); color: white;
        padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 700;
        backdrop-filter: blur(4px);
    }
    .card-title { font-size: 0.9rem; font-weight: 700; text-align: center; color: var(--text); line-height: 1.3; }
    .card-year { font-size: 0.8rem; text-align: center; color: var(--muted); margin-top: 4px; }

    /* Modal Styles */
    .overlay { 
        position: fixed; inset: 0; background: rgba(15, 23, 42, 0.85); display: none; 
        align-items: center; justify-content: center; z-index: 2000; backdrop-filter: blur(8px); padding: 20px; 
    }
    .modal { 
        background: white; padding: 0; border-radius: 24px; max-width: 800px; width: 100%; 
        position: relative; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); overflow: hidden;
        display: flex; flex-direction: row; 
    }
    .modal-poster { width: 300px; height: 450px; object-fit: cover; flex-shrink: 0; }
    .modal-content { padding: 40px; overflow-y: auto; max-height: 450px; width: 100%; }
    .close-btn { 
        position: absolute; top: 20px; right: 20px; cursor: pointer; width: 32px; height: 32px;
        background: rgba(0,0,0,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center;
        font-size: 1.2rem; transition: 0.2s; z-index: 10;
    }
    .close-btn:hover { background: rgba(0,0,0,0.2); }
    
    .modal h2 { font-size: 2rem; margin-bottom: 10px; line-height: 1.1; }
    .tag-row { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
    .tag { padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
    .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; border-top: 1px solid #f1f5f9; border-bottom: 1px solid #f1f5f9; padding: 20px 0; }
    .info-item h4 { font-size: 0.75rem; text-transform: uppercase; color: var(--muted); margin-bottom: 4px; }
    .info-item p { font-weight: 600; color: var(--text); }
    .synopsis { color: var(--muted); line-height: 1.6; font-size: 0.95rem; }

    /* Animation Classes */
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
    .floating-dot { animation: float 4s ease-in-out infinite; }

    @media (max-width: 768px) {
        .modal { flex-direction: column; max-height: 90vh; overflow-y: scroll; }
        .modal-poster { width: 100%; height: 200px; }
        .modal-content { padding: 25px; }
        h1 { font-size: 2rem; }
    }
</style>
</head>
<body>

<button class="lang-toggle" onclick="toggleLang()">EN / FR</button>

<header>
    <h1 id="txt-title">Cinema Box Office</h1>
    <p id="txt-subtitle" class="subtitle">Interactive analysis of the 55 highest-grossing films (2013-2023)</p>
</header>

<nav id="navbar">
    <div class="nav-item active" onclick="setView('overview', event)" data-key="nav_ov">Overview</div>
    <div class="nav-item" onclick="setView('genres', event)" data-key="nav_gr">Genre Analysis</div>
    <div class="nav-item" onclick="setView('directors', event)" data-key="nav_dr">Top Directors</div>
    <div class="nav-item" onclick="setView('timeline', event)" data-key="nav_tl">Timeline</div>
    <div class="nav-item" onclick="setView('gallery', event)" data-key="nav_gy">Movie Gallery</div>
</nav>

<div id="stage"></div>
<div id="legend-box"></div>

<div id="overlay" class="overlay" onclick="closeModal()">
    <div class="modal" onclick="event.stopPropagation()">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <img id="m-poster" class="modal-poster" src="" alt="Poster">
        <div class="modal-content">
            <h2 id="m-title">Movie Title</h2>
            <div class="tag-row" id="m-tags"></div>
            <div class="info-grid">
                <div class="info-item">
                    <h4 data-key="rev">Revenue</h4>
                    <p id="m-rev">$0M</p>
                </div>
                <div class="info-item">
                    <h4 data-key="dir">Director</h4>
                    <p id="m-dir">Name</p>
                </div>
                <div class="info-item">
                    <h4 data-key="act">Starring</h4>
                    <p id="m-cast">Actors</p>
                </div>
                <div class="info-item">
                    <h4 data-key="country">Country</h4>
                    <p id="m-country">USA</p>
                </div>
            </div>
            <div class="info-item">
                <h4 data-key="syn">Synopsis</h4>
                <p id="m-desc" class="synopsis">Description...</p>
            </div>
        </div>
    </div>
</div>

<script>
// === COMPLETE DATASET (55 MOVIES) WITH POSTERS, SYNOPSIS, ACTORS ===
const rawData = [
  // 2013
  {y:2013,r:1,t:"Frozen",rev:1280.8,g:"Animation",c:"USA",d:"Chris Buck, Jennifer Lee",gen:"Mixed",p:"https://image.tmdb.org/t/p/w500/kgwjIbS69p968L7VvK5MoY7960G.jpg",act:"Kristen Bell, Idina Menzel",desc:"Young princess Anna of Arendelle dreams about finding true love at her sister Elsa’s coronation. Fate takes her on a dangerous journey in an icy kingdom."},
  {y:2013,r:2,t:"Iron Man 3",rev:1214.8,g:"Action",c:"USA",d:"Shane Black",gen:"Male",p:"https://image.tmdb.org/t/p/w500/qhPtRUW9H7TMz0r6T6IKTV99D5p.jpg",act:"Robert Downey Jr., Gwyneth Paltrow",desc:"When Tony Stark's world is torn apart by a formidable terrorist called the Mandarin, he starts an odyssey of rebuilding and retribution."},
  {y:2013,r:3,t:"Despicable Me 2",rev:970.8,g:"Animation",c:"USA",d:"Pierre Coffin, Chris Renaud",gen:"Male",p:"https://image.tmdb.org/t/p/w500/5S09h7YmB9pSAti6Y8062V18KkK.jpg",act:"Steve Carell, Kristen Wiig",desc:"Gru is recruited by the Anti-Villain League to help deal with a powerful new super criminal."},
  {y:2013,r:4,t:"The Hobbit: Desolation of Smaug",rev:958.4,g:"Fantasy",c:"NZL/USA",d:"Peter Jackson",gen:"Male",p:"https://image.tmdb.org/t/p/w500/vE9C8HIn8yGTM8H9WpE88X9Bv3k.jpg",act:"Martin Freeman, Ian McKellen",desc:"The dwarves, along with Bilbo Baggins and Gandalf the Grey, continue their quest to reclaim Erebor, their homeland, from Smaug."},
  {y:2013,r:5,t:"The Hunger Games: Catching Fire",rev:865.0,g:"Science Fiction",c:"USA",d:"Francis Lawrence",gen:"Male",p:"https://image.tmdb.org/t/p/w500/v067N9pC5p7fR6H3R8Xk9v9m6P3.jpg",act:"Jennifer Lawrence, Josh Hutcherson",desc:"Katniss Everdeen and Peeta Mellark become targets of the Capitol after their victory in the 74th Hunger Games sparks a rebellion."},
  
  // 2014
  {y:2014,r:1,t:"Transformers: Age of Extinction",rev:1104.1,g:"Action",c:"USA",d:"Michael Bay",gen:"Male",p:"https://image.tmdb.org/t/p/w500/77S99Xp88P4nS6394P6n4N69p63.jpg",act:"Mark Wahlberg, Stanley Tucci",desc:"A mechanic and his family join the Autobots as they are targeted by a bounty hunter from another world."},
  {y:2014,r:2,t:"The Hobbit: Battle of Five Armies",rev:962.2,g:"Fantasy",c:"NZL/USA",d:"Peter Jackson",gen:"Male",p:"https://image.tmdb.org/t/p/w500/x7S6XmInZ669rS97v9C867vYovR.jpg",act:"Martin Freeman, Ian McKellen",desc:"Bilbo and company are forced to engage in a war against an array of combatants and keep the Lonely Mountain from falling into the hands of a rising darkness."},
  {y:2014,r:3,t:"Guardians of the Galaxy",rev:773.4,g:"Action",c:"USA",d:"James Gunn",gen:"Male",p:"https://image.tmdb.org/t/p/w500/r7DuyYJszVI0XYBRuL7QpXjG1N5.jpg",act:"Chris Pratt, Zoe Saldana",desc:"A group of intergalactic criminals must pull together to stop a fanatical warrior with plans to purge the universe."},
  {y:2014,r:4,t:"Maleficent",rev:758.5,g:"Fantasy",c:"USA",d:"Robert Stromberg",gen:"Male",p:"https://image.tmdb.org/t/p/w500/ik89Go3S6M3p9T6f0sz2Yf08GBy.jpg",act:"Angelina Jolie, Elle Fanning",desc:"A vengeful fairy is driven to curse an infant princess, only to discover that the child may be the one person who can restore peace to their troubled land."},
  {y:2014,r:5,t:"Hunger Games: Mockingjay – Part 1",rev:755.4,g:"Science Fiction",c:"USA",d:"Francis Lawrence",gen:"Male",p:"https://image.tmdb.org/t/p/w500/gj2H2icB6YFp88o36vPbZ6E94rb.jpg",act:"Jennifer Lawrence, Josh Hutcherson",desc:"Katniss Everdeen is in District 13 after she shatters the games forever. Under the leadership of President Coin, she fights to save Peeta."},

  // 2015
  {y:2015,r:1,t:"Star Wars: The Force Awakens",rev:2068.2,g:"Science Fiction",c:"USA",d:"J.J. Abrams",gen:"Male",p:"https://image.tmdb.org/t/p/w500/wqn6ibpSFFXxFWLgH0aR3J9tdnk.jpg",act:"Harrison Ford, Daisy Ridley",desc:"Three decades after the Empire's defeat, a new threat arises in the militant First Order. Defected stormtrooper Finn and the scavenger Rey are caught up in the Resistance's search for the missing Luke Skywalker."},
  {y:2015,r:2,t:"Jurassic World",rev:1671.5,g:"Science Fiction",c:"USA",d:"Colin Trevorrow",gen:"Male",p:"https://image.tmdb.org/t/p/w500/r7DuyYJszVI0XYBRuL7QpXjG1N5.jpg",act:"Chris Pratt, Bryce Dallas Howard",desc:"A new theme park, built on the original site of Jurassic Park, creates a genetically modified hybrid dinosaur, the Indominus Rex, which escapes containment and goes on a killing spree."},
  {y:2015,r:3,t:"Furious 7",rev:1515.3,g:"Action",c:"USA",d:"James Wan",gen:"Male",p:"https://image.tmdb.org/t/p/w500/kto1dJ31peDciF6X5iECA0cZ9k.jpg",act:"Vin Diesel, Paul Walker",desc:"Deckard Shaw seeks revenge against Dominic Toretto and his family for his comatose brother."},
  {y:2015,r:4,t:"Avengers: Age of Ultron",rev:1402.8,g:"Action",c:"USA",d:"Joss Whedon",gen:"Male",p:"https://image.tmdb.org/t/p/w500/4ssDuvEDkSArWEdyBl2X5EHvYKU.jpg",act:"Robert Downey Jr., Chris Evans",desc:"When Tony Stark and Bruce Banner try to jump-start a dormant peacekeeping program called Ultron, things go horribly wrong."},
  {y:2015,r:5,t:"Minions",rev:1159.4,g:"Animation",c:"USA",d:"Pierre Coffin, Kyle Balda",gen:"Male",p:"https://image.tmdb.org/t/p/w500/q0Rmk7mS74g9R909R96464646.jpg",act:"Sandra Bullock, Jon Hamm",desc:"Minions Kevin, Stuart and Bob decide to find a new master. They embark on a global trip and meet Scarlet Overkill."},

  // 2016
  {y:2016,r:1,t:"Captain America: Civil War",rev:1153.3,g:"Action",c:"USA",d:"Anthony & Joe Russo",gen:"Male",p:"https://image.tmdb.org/t/p/w500/rAGiXaUfPu0D38NzvDkJPXJBeBf.jpg",act:"Chris Evans, Robert Downey Jr.",desc:"Political interference in the Avengers' activities causes a rift between former allies Captain America and Iron Man."},
  {y:2016,r:2,t:"Rogue One: A Star Wars Story",rev:1056.1,g:"Science Fiction",c:"USA",d:"Gareth Edwards",gen:"Male",p:"https://image.tmdb.org/t/p/w500/5jX9pSAti6Y8062V18KkK.jpg",act:"Felicity Jones, Diego Luna",desc:"The daughter of an Imperial scientist joins the Rebel Alliance in a risky move to steal the plans for the Death Star."},
  {y:2016,r:3,t:"Finding Dory",rev:1028.6,g:"Animation",c:"USA",d:"Andrew Stanton",gen:"Male",p:"https://image.tmdb.org/t/p/w500/369p6363.jpg",act:"Ellen DeGeneres, Albert Brooks",desc:"Friendly but forgetful blue tang Dory begins a search for her long-lost parents, and everyone learns a few things about the real meaning of family along the way."},
  {y:2016,r:4,t:"Zootopia",rev:1025.5,g:"Animation",c:"USA",d:"Byron Howard, Rich Moore",gen:"Male",p:"https://image.tmdb.org/t/p/w500/hlK0e0wAQ3VLuJcsfIYPvb4JVud.jpg",act:"Ginnifer Goodwin, Jason Bateman",desc:"In a city of anthropomorphic animals, a rookie bunny cop and a cynical con artist fox must work together to uncover a conspiracy."},
  {y:2016,r:5,t:"The Jungle Book",rev:967.7,g:"Fantasy",c:"USA",d:"Jon Favreau",gen:"Male",p:"https://image.tmdb.org/t/p/w500/vIu4cIVlmUCPPCgPKDJ0J2CcwfO.jpg",act:"Neel Sethi, Bill Murray",desc:"After a threat from the tiger Shere Khan forces him to flee the jungle, a man-cub named Mowgli embarks on a journey of self discovery."},

  // 2017
  {y:2017,r:1,t:"Star Wars: The Last Jedi",rev:1334.4,g:"Science Fiction",c:"USA",d:"Rian Johnson",gen:"Male",p:"https://image.tmdb.org/t/p/w500/kOVEVeg59E0wsnXmF9nrh6OmWII.jpg",act:"Mark Hamill, Adam Driver",desc:"Rey develops her newly discovered abilities with the guidance of Luke Skywalker, who is unsettled by the strength of her powers."},
  {y:2017,r:2,t:"Beauty and the Beast",rev:1266.1,g:"Fantasy",c:"USA",d:"Bill Condon",gen:"Male",p:"https://image.tmdb.org/t/p/w500/hKegSKIDep2ewJWPUQD7u0KqFIp.jpg",act:"Emma Watson, Dan Stevens",desc:"A selfish Prince is cursed to become a monster for the rest of his life, unless he learns to fall in love with a beautiful young woman he keeps prisoner."},
  {y:2017,r:3,t:"The Fate of the Furious",rev:1236.0,g:"Action",c:"USA",d:"F. Gary Gray",gen:"Male",p:"https://image.tmdb.org/t/p/w500/dImWM7GJqryWJO9LHa3XQ8DD5NH.jpg",act:"Vin Diesel, Jason Statham",desc:"When a mysterious woman seduces Dom into the world of crime and a betrayal of those closest to him, the crew face trials that will test them as never before."},
  {y:2017,r:4,t:"Despicable Me 3",rev:1034.8,g:"Animation",c:"USA",d:"Kyle Balda",gen:"Male",p:"https://image.tmdb.org/t/p/w500/6t3YwxJ7UK3N8i16IGmt5IyaHii.jpg",act:"Steve Carell, Kristen Wiig",desc:"Gru meets his long-lost charming, cheerful, and more successful twin brother Dru who wants to team up with him for one last criminal heist."},
  {y:2017,r:5,t:"Jumanji: Welcome to the Jungle",rev:962.1,g:"Adventure",c:"USA",d:"Jake Kasdan",gen:"Male",p:"https://image.tmdb.org/t/p/w500/bXrZ5iHBEjH7WMidbUDQ0U2xbmr.jpg",act:"Dwayne Johnson, Jack Black",desc:"Four teenagers are sucked into a magical video game, and the only way they can escape is to work together to finish the game."},

  // 2018
  {y:2018,r:1,t:"Avengers: Infinity War",rev:2048.4,g:"Action",c:"USA",d:"Anthony & Joe Russo",gen:"Male",p:"https://image.tmdb.org/t/p/w500/7WsyChQLEftFiDOVTGkv3hFpyyt.jpg",act:"Robert Downey Jr., Chris Hemsworth",desc:"The Avengers and their allies must be willing to sacrifice all in an attempt to defeat the powerful Thanos before his blitz of devastation and ruin is put to an end."},
  {y:2018,r:2,t:"Black Panther",rev:1347.6,g:"Action",c:"USA",d:"Ryan Coogler",gen:"Male",p:"https://image.tmdb.org/t/p/w500/uxzzxijgPIY7slzFvMotPv8wjKA.jpg",act:"Chadwick Boseman, Michael B. Jordan",desc:"T'Challa, heir to the hidden but advanced kingdom of Wakanda, must step forward to lead his people into a new future and must confront a challenger from his country's past."},
  {y:2018,r:3,t:"Jurassic World: Fallen Kingdom",rev:1308.5,g:"Science Fiction",c:"USA",d:"J.A. Bayona",gen:"Male",p:"https://image.tmdb.org/t/p/w500/c9XxwwhPHdaImA2f1WEfEsbhaFB.jpg",act:"Chris Pratt, Bryce Dallas Howard",desc:"When the island's dormant volcano begins roaring to life, Owen and Claire mount a campaign to rescue the remaining dinosaurs from this extinction-level event."},
  {y:2018,r:4,t:"Incredibles 2",rev:1242.8,g:"Animation",c:"USA",d:"Brad Bird",gen:"Male",p:"https://image.tmdb.org/t/p/w500/9lFKBtbrXOZCf9sSuYkhvpTrCBQ.jpg",act:"Craig T. Nelson, Holly Hunter",desc:"The Incredibles hero family takes on a new mission which involves a change in family roles: Bob Parr (Mr. Incredible) must manage the house while his wife Helen (Elastigirl) goes out to save the world."},
  {y:2018,r:5,t:"Aquaman",rev:1148.5,g:"Action",c:"USA",d:"James Wan",gen:"Male",p:"https://image.tmdb.org/t/p/w500/5Kg76ldv7VxeX9YlcQXiowHgdX6.jpg",act:"Jason Momoa, Amber Heard",desc:"Arthur Curry, the human-born heir to the underwater kingdom of Atlantis, goes on a quest to prevent a war between the worlds of ocean and land."},

  // 2019
  {y:2019,r:1,t:"Avengers: Endgame",rev:2797.5,g:"Action",c:"USA",d:"Anthony & Joe Russo",gen:"Male",p:"https://image.tmdb.org/t/p/w500/or06FN3Dka5tukK1e9sl16pB3iy.jpg",act:"Robert Downey Jr., Chris Evans",desc:"After the devastating events of Infinity War, the universe is in ruins. With the help of remaining allies, the Avengers assemble once more in order to reverse Thanos' actions and restore balance to the universe."},
  {y:2019,r:2,t:"The Lion King",rev:1656.9,g:"Animation",c:"USA",d:"Jon Favreau",gen:"Male",p:"https://image.tmdb.org/t/p/w500/2bXbqYdUdNVa8VIWXVfclP2ICtT.jpg",act:"Donald Glover, Beyoncé",desc:"After the murder of his father, a young lion prince flees his kingdom only to learn the true meaning of responsibility and bravery."},
  {y:2019,r:3,t:"Frozen II",rev:1450.0,g:"Animation",c:"USA",d:"Chris Buck, Jennifer Lee",gen:"Mixed",p:"https://image.tmdb.org/t/p/w500/pjeMs3yqRmFL3giJy4PMXWZTTPa.jpg",act:"Kristen Bell, Idina Menzel",desc:"Anna, Elsa, Kristoff, Olaf and Sven leave Arendelle to travel to an ancient, autumn-bound forest of an enchanted land to find the origin of Elsa's powers."},
  {y:2019,r:4,t:"Spider-Man: Far From Home",rev:1131.9,g:"Action",c:"USA",d:"Jon Watts",gen:"Male",p:"https://image.tmdb.org/t/p/w500/4q2NNj4S5dG2RLF9CpXsej7yXl.jpg",act:"Tom Holland, Samuel L. Jackson",desc:"Following the events of Avengers: Endgame, Spider-Man must step up to take on new threats in a world that has changed forever."},
  {y:2019,r:5,t:"Captain Marvel",rev:1128.5,g:"Action",c:"USA",d:"Anna Boden, Ryan Fleck",gen:"Mixed",p:"https://image.tmdb.org/t/p/w500/AtsgWhDnHTq68L0lLsUrCnM7TjG.jpg",act:"Brie Larson, Samuel L. Jackson",desc:"Carol Danvers becomes one of the universe's most powerful heroes when Earth is caught in the middle of a galactic war between two alien races."},

  // 2020
  {y:2020,r:1,t:"The Eight Hundred",rev:461.4,g:"War",c:"China",d:"Guan Hu",gen:"Male",p:"https://image.tmdb.org/t/p/w500/kSf9svfL2WrKeuK8W08xeR5lTn8.jpg",act:"Huang Zhizhong, Oho Ou",desc:"From the acclaimed filmmaker behind Mr. Six comes a riveting war epic. In 1937, eight hundred Chinese soldiers fight under siege from a warehouse in the middle of the Shanghai battlefield, surrounded by the Japanese army."},
  {y:2020,r:2,t:"Bad Boys for Life",rev:426.5,g:"Action",c:"USA",d:"Adil El Arbi, Bilall Fallah",gen:"Male",p:"https://image.tmdb.org/t/p/w500/y95lQLnuNKdPAzw9F9Ab8kJ80c3.jpg",act:"Will Smith, Martin Lawrence",desc:"Miami detectives Mike Lowrey and Marcus Burnett must face off against a mother-and-son pair of drug lords who wreak vengeful havoc on their city."},
  {y:2020,r:3,t:"My People, My Homeland",rev:422.4,g:"Comedy",c:"China",d:"Collectif",gen:"Male",p:"https://image.tmdb.org/t/p/w500/6DPFmr5w1IvjT28HmLlK1bBzB56.jpg",act:"Ge You, Huang Bo",desc:"An anthology comedy film consisting of five stories about the lives of Chinese people in different regions."},
  {y:2020,r:4,t:"Tenet",rev:365.3,g:"Science Fiction",c:"USA",d:"Christopher Nolan",gen:"Male",p:"https://image.tmdb.org/t/p/w500/k68nPLbIST6NP96JmTxmZijEvCA.jpg",act:"John David Washington, Robert Pattinson",desc:"Armed with only one word, Tenet, and fighting for the survival of the entire world, a Protagonist journeys through a twilight world of international espionage on a mission that will unfold in something beyond real time."},
  {y:2020,r:5,t:"Sonic the Hedgehog",rev:319.7,g:"Adventure",c:"USA",d:"Jeff Fowler",gen:"Male",p:"https://image.tmdb.org/t/p/w500/aQvJ5WPzZgYVDrxLX4R6cLJCEaQ.jpg",act:"Ben Schwartz, James Marsden",desc:"After discovering a small, blue, fast hedgehog, a small-town police officer must help it defeat an evil genius who wants to do experiments on it."},

  // 2021
  {y:2021,r:1,t:"Spider-Man: No Way Home",rev:1921.8,g:"Action",c:"USA",d:"Jon Watts",gen:"Male",p:"https://image.tmdb.org/t/p/w500/1g0dhYtq4irTY1GPXvft6k4YLjm.jpg",act:"Tom Holland, Zendaya",desc:"With Spider-Man's identity now revealed, Peter asks Doctor Strange for help. When a spell goes wrong, dangerous foes from other worlds start to appear, forcing Peter to discover what it truly means to be Spider-Man."},
  {y:2021,r:2,t:"The Battle at Lake Changjin",rev:902.5,g:"War",c:"China",d:"Chen Kaige",gen:"Male",p:"https://image.tmdb.org/t/p/w500/9Yw8Kddk26gPASq2fDpvCDq93EZ.jpg",act:"Wu Jing, Jackson Yee",desc:"Set during the Korean War, this film tells the story of the Chinese People's Volunteer Army soldiers who fought against US forces at Lake Changjin in freezing conditions."},
  {y:2021,r:3,t:"Hi, Mom",rev:841.7,g:"Comedy",c:"China",d:"Jia Ling",gen:"Female",p:"https://image.tmdb.org/t/p/w500/hAs6GHHqcNrzcHL26mxp0H0qqiN.jpg",act:"Jia Ling, Zhang Xiaofei",desc:"After her mother is fatally injured in a car accident, a grief-stricken daughter travels back in time to 1981, where she becomes her mother's best friend and tries to give her a better life."},
  {y:2021,r:4,t:"No Time to Die",rev:774.2,g:"Action",c:"UK/USA",d:"Cary Joji Fukunaga",gen:"Male",p:"https://image.tmdb.org/t/p/w500/iUgygt3fscRoKWCV1d0C7FbM9TP.jpg",act:"Daniel Craig, Rami Malek",desc:"James Bond has left active service. His peace is short-lived when Felix Leiter, an old friend from the CIA, turns up asking for help, leading Bond onto the trail of a mysterious villain armed with dangerous new technology."},
  {y:2021,r:5,t:"F9",rev:726.2,g:"Action",c:"USA",d:"Justin Lin",gen:"Male",p:"https://image.tmdb.org/t/p/w500/bOFaAXmWWXC3Rbv4u4uM9ZSzRXP.jpg",act:"Vin Diesel, John Cena",desc:"Dom and the crew must take on an international terrorist who turns out to be Dom and Mia's estranged brother."},

  // 2022
  {y:2022,r:1,t:"Avatar: The Way of Water",rev:2320.3,g:"Science Fiction",c:"USA",d:"James Cameron",gen:"Male",p:"https://image.tmdb.org/t/p/w500/t6HIqrRAclMCA60NsSmeqe9RmNV.jpg",act:"Sam Worthington, Zoe Saldana",desc:"Jake Sully lives with his newfound family formed on the extrasolar moon Pandora. Once a familiar threat returns to finish what was previously started, Jake must work with Neytiri and the army of the Na'vi race to protect their home."},
  {y:2022,r:2,t:"Top Gun: Maverick",rev:1495.7,g:"Action",c:"USA",d:"Joseph Kosinski",gen:"Male",p:"https://image.tmdb.org/t/p/w500/62HCnUTziyWcpDaBO2i1DX17ljH.jpg",act:"Tom Cruise, Miles Teller",desc:"After thirty years, Maverick is still pushing the envelope as a top naval aviator, but must confront ghosts of his past when he leads TOP GUN's elite graduates on a mission that demands the ultimate sacrifice."},
  {y:2022,r:3,t:"Jurassic World Dominion",rev:1002.0,g:"Science Fiction",c:"USA",d:"Colin Trevorrow",gen:"Male",p:"https://image.tmdb.org/t/p/w500/kAVRgw7GgK1CfYEJq8ME6EvRIgU.jpg",act:"Chris Pratt, Bryce Dallas Howard",desc:"Four years after the destruction of Isla Nublar, dinosaurs now live—and hunt—alongside humans all over the world. This fragile balance will reshape the future and determine, once and for all, whether human beings are to remain the apex predators."},
  {y:2022,r:4,t:"Doctor Strange in the Multiverse of Madness",rev:955.8,g:"Action",c:"USA",d:"Sam Raimi",gen:"Male",p:"https://image.tmdb.org/t/p/w500/9Gtg2DzBhmYamXBS1hKAhiwbBKS.jpg",act:"Benedict Cumberbatch, Elizabeth Olsen",desc:"Doctor Strange teams up with a mysterious teenage girl from his dreams who can travel across multiverses, to battle multiple threats, including other-universe versions of himself."},
  {y:2022,r:5,t:"Minions: The Rise of Gru",rev:940.2,g:"Animation",c:"USA",d:"Kyle Balda",gen:"Male",p:"https://image.tmdb.org/t/p/w500/wKiOkZTN9lUUUNZLmtnwubZYONg.jpg",act:"Steve Carell, Pierre Coffin",desc:"The untold story of one twelve-year-old's dream to become the world's greatest supervillain."},

  // 2023
  {y:2023,r:1,t:"Barbie",rev:1445.6,g:"Comedy",c:"USA",d:"Greta Gerwig",gen:"Female",p:"https://image.tmdb.org/t/p/w500/iuFNMS8U5cb6xfzi51Dbkovj7vM.jpg",act:"Margot Robbie, Ryan Gosling",desc:"Barbie and Ken are having the time of their lives in the colorful and seemingly perfect world of Barbie Land. However, when they get a chance to go to the real world, they soon discover the joys and perils of living among humans."},
  {y:2023,r:2,t:"The Super Mario Bros. Movie",rev:1362.0,g:"Animation",c:"USA",d:"Aaron Horvath, Michael Jelenic",gen:"Male",p:"https://image.tmdb.org/t/p/w500/qNBAXBIQlnOThrVvA6mA2B5ggV6.jpg",act:"Chris Pratt, Anya Taylor-Joy",desc:"While working underground to fix a water main, Brooklyn plumbers—and brothers—Mario and Luigi are transported down a mysterious pipe and wander into a magical new world."},
  {y:2023,r:3,t:"Oppenheimer",rev:975.4,g:"Drama",c:"USA",d:"Christopher Nolan",gen:"Male",p:"https://image.tmdb.org/t/p/w500/8Gxv8gSFCU0XGDykEGv7zR1n2ua.jpg",act:"Cillian Murphy, Emily Blunt",desc:"The story of J. Robert Oppenheimer's role in the development of the atomic bomb during World War II."},
  {y:2023,r:4,t:"Guardians of the Galaxy Vol. 3",rev:845.6,g:"Action",c:"USA",d:"James Gunn",gen:"Male",p:"https://image.tmdb.org/t/p/w500/r2J02Z2OpNTctfOSN1Ydgii51I3.jpg",act:"Chris Pratt, Zoe Saldana",desc:"Still reeling from the loss of Gamora, Peter Quill rallies his team to defend the universe and one of their own - a mission that could mean the end of the Guardians if not successful."},
  {y:2023,r:5,t:"Fast X",rev:704.9,g:"Action",c:"USA",d:"Louis Leterrier",gen:"Male",p:"https://image.tmdb.org/t/p/w500/fiVW06jE7z9YnO4trhaMEdclSiC.jpg",act:"Vin Diesel, Jason Momoa",desc:"Dom Toretto and his family are targeted by the vengeful son of drug kingpin Hernan Reyes."}
];

const langDict = {
    en: {
        title: "Cinema Box Office", sub: "Interactive analysis of the 55 highest-grossing films (2013-2023)",
        nav_ov: "Overview", nav_gr: "Genre Analysis", nav_dr: "Top Directors", nav_tl: "Timeline", nav_gy: "Movie Gallery",
        rev: "Revenue", dir: "Director", act: "Starring", country: "Production", syn: "Synopsis", gen: "Genre",
        m: "Male / Men", f: "Female", mix: "Mixed Team"
    },
    fr: {
        title: "Le Box-Office Mondial", sub: "Analyse interactive des 55 plus grands succès (2013-2023)",
        nav_ov: "Vue d'ensemble", nav_gr: "Par Genre", nav_dr: "Réalisateurs", nav_tl: "Chronologie", nav_gy: "Galerie Films",
        rev: "Recettes", dir: "Réalisateur", act: "Acteurs", country: "Production", syn: "Synopsis", gen: "Genre",
        m: "Homme", f: "Femme", mix: "Mixte"
    }
};

let currentLang = 'en';
// FIXED: Distinct colors for Fantasy (#d946ef) vs Drama (#4f46e5)
const genreColors = {
    "Action": "var(--c-action)", "Animation": "var(--c-animation)", "Fantasy": "var(--c-fantasy)",
    "Science Fiction": "var(--c-scifi)", "Comedy": "var(--c-comedy)", "Adventure": "var(--c-adventure)",
    "Drama": "var(--c-drama)", "War": "var(--c-war)"
};

function toggleLang() {
    currentLang = currentLang === 'en' ? 'fr' : 'en';
    const d = langDict[currentLang];
    d3.select("#txt-title").text(d.title);
    d3.select("#txt-subtitle").text(d.sub);
    d3.selectAll("[data-key]").each(function() {
        d3.select(this).text(d[d3.select(this).attr("data-key")]);
    });
    const activeView = d3.select(".nav-item.active").attr("onclick").split("'")[1];
    setView(activeView);
}

function setView(type, e) {
    if(e) {
        d3.selectAll(".nav-item").classed("active", false);
        d3.select(e.target).classed("active", true);
    }
    d3.select("#stage").html("");
    d3.select("#legend-box").html("");

    if(type === 'overview') renderOverview();
    if(type === 'genres') renderGenres();
    if(type === 'directors') renderDirectors();
    if(type === 'timeline') renderTimeline();
    if(type === 'gallery') renderGallery();
}

function renderOverview() {
    const margin = {top: 40, right: 40, bottom: 50, left: 70},
          width = document.getElementById('stage').offsetWidth - margin.left - margin.right,
          height = 500 - margin.top - margin.bottom;

    const svg = d3.select("#stage").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
      .append("g").attr("transform", `translate(${margin.left},${margin.top})`);

    const x = d3.scaleLinear().domain([2012.5, 2023.5]).range([0, width]);
    const y = d3.scaleLinear().domain([0, 3000]).range([height, 0]);

    svg.append("g").attr("transform", `translate(0,${height})`).call(d3.axisBottom(x).tickFormat(d3.format("d")));
    svg.append("g").call(d3.axisLeft(y).tickFormat(d => `$${d}M`));

    // Floating dots
    svg.selectAll(".dot").data(rawData).enter().append("circle")
        .attr("class", "floating-dot")
        .attr("cx", d => x(d.y)).attr("cy", d => y(d.rev)).attr("r", 9)
        .attr("fill", d => genreColors[d.g])
        .style("cursor", "pointer").style("stroke", "white").style("stroke-width", 2)
        .on("click", (e, d) => openModal(d));

    // Legend
    const leg = d3.select("#legend-box").append("div").attr("class", "legend");
    Object.entries(genreColors).forEach(([name, color]) => {
        const item = leg.append("div").attr("class", "legend-item");
        item.append("div").attr("class", "legend-dot").style("background", color);
        item.append("span").text(name);
    });
}

function renderGenres() {
    const margin = {top: 20, right: 30, bottom: 40, left: 120};
    const width = document.getElementById('stage').offsetWidth - margin.left - margin.right;
    const gData = d3.rollups(rawData, v => d3.sum(v, d => d.rev), d => d.g).sort((a,b) => b[1] - a[1]);
    const height = gData.length * 50;

    const svg = d3.select("#stage").append("svg").attr("width", width + margin.left + margin.right).attr("height", height + margin.top + margin.bottom).append("g").attr("transform", `translate(${margin.left},${margin.top})`);
    const x = d3.scaleLinear().domain([0, d3.max(gData, d => d[1])]).range([0, width]);
    const y = d3.scaleBand().domain(gData.map(d => d[0])).range([0, height]).padding(0.3);

    svg.selectAll("rect").data(gData).enter().append("rect")
       .attr("y", d => y(d[0])).attr("height", y.bandwidth())
       .attr("fill", d => genreColors[d[0]])
       .attr("width", 0).transition().duration(1000).attr("width", d => x(d[1]));

    svg.append("g").call(d3.axisLeft(y));
}

function renderDirectors() {
    const margin = {top: 20, right: 30, bottom: 40, left: 160};
    const width = document.getElementById('stage').offsetWidth - margin.left - margin.right;
    const data = d3.rollups(rawData, v => ({val: d3.sum(v, d => d.rev), gen: v[0].gen}), d => d.d).sort((a,b) => b[1].val - a[1].val).slice(0, 10);
    const height = 450;

    const svg = d3.select("#stage").append("svg").attr("width", width + margin.left + margin.right).attr("height", height + margin.top + margin.bottom).append("g").attr("transform", `translate(${margin.left},${margin.top})`);
    const x = d3.scaleLinear().domain([0, d3.max(data, d => d[1].val)]).range([0, width]);
    const y = d3.scaleBand().domain(data.map(d => d[0])).range([0, height]).padding(0.4);

    svg.selectAll("rect").data(data).enter().append("rect")
       .attr("y", d => y(d[0])).attr("height", y.bandwidth())
       .attr("fill", d => d[1].gen === 'Female' ? 'var(--female)' : d[1].gen === 'Mixed' ? 'var(--mixed)' : 'var(--male)')
       .attr("width", 0).transition().duration(1000).attr("width", d => x(d[1].val));

    svg.append("g").call(d3.axisLeft(y));

    // Legend for Gender
    const leg = d3.select("#legend-box").append("div").attr("class", "legend");
    [['m','var(--male)'],['f','var(--female)'],['mix','var(--mixed)']].forEach(([k,c]) => {
        leg.append("div").attr("class", "legend-item")
           .html(`<div class="legend-dot" style="background:${c}"></div><span>${langDict[currentLang][k]}</span>`);
    });
}

function renderTimeline() {
    const margin = {top: 30, right: 30, bottom: 40, left: 70};
    const width = document.getElementById('stage').offsetWidth - margin.left - margin.right;
    const height = 400;
    const data = d3.rollups(rawData, v => d3.sum(v, d => d.rev), d => d.y).sort((a,b) => a[0]-b[0]);

    const svg = d3.select("#stage").append("svg").attr("width", width + margin.left + margin.right).attr("height", height + margin.top + margin.bottom).append("g").attr("transform", `translate(${margin.left},${margin.top})`);
    const x = d3.scaleLinear().domain([2013, 2023]).range([0, width]);
    const y = d3.scaleLinear().domain([0, d3.max(data, d => d[1])]).range([height, 0]);

    const area = d3.area().x(d => x(d[0])).y0(height).y1(d => y(d[1])).curve(d3.curveMonotoneX);
    const line = d3.line().x(d => x(d[0])).y(d => y(d[1])).curve(d3.curveMonotoneX);

    svg.append("path").datum(data).attr("fill", "#e0f2fe").attr("d", area);
    const path = svg.append("path").datum(data).attr("fill", "none").attr("stroke", "var(--accent)").attr("stroke-width", 4).attr("d", line);
    
    const len = path.node().getTotalLength();
    path.attr("stroke-dasharray", len + " " + len).attr("stroke-dashoffset", len).transition().duration(2500).ease(d3.easeLinear).attr("stroke-dashoffset", 0);

    svg.append("g").attr("transform", `translate(0,${height})`).call(d3.axisBottom(x).tickFormat(d3.format("d")));
    svg.append("g").call(d3.axisLeft(y).tickFormat(d => `$${d}M`));
}

function renderGallery() {
    const grid = d3.select("#stage").append("div").attr("class", "movie-grid");
    grid.selectAll(".card").data(rawData).enter().append("div").attr("class", "movie-card")
        .html(d => `
            <div class="poster-wrap">
                <div class="rank-tag">#${d.r}</div>
                <img src="${d.p}" loading="lazy">
            </div>
            <div class="card-title">${d.t}</div>
            <div class="card-year">${d.y}</div>
        `)
        .on("click", (e, d) => openModal(d));
}

function openModal(d) {
    document.getElementById('overlay').style.display = 'flex';
    document.getElementById('m-poster').src = d.p;
    document.getElementById('m-title').innerText = d.t;
    document.getElementById('m-rev').innerText = `$${d.rev} Million`;
    document.getElementById('m-dir').innerText = d.d;
    document.getElementById('m-cast').innerText = d.act;
    document.getElementById('m-country').innerText = d.c;
    document.getElementById('m-desc').innerText = d.desc;
    
    const tags = document.getElementById('m-tags');
    tags.innerHTML = `
        <span class="tag" style="background:${genreColors[d.g]}; color:white">${d.g}</span>
        <span class="tag" style="background:#e2e8f0; color:#475569">${d.y}</span>
    `;
}

function closeModal() { document.getElementById('overlay').style.display = 'none'; }

// Init
setView('overview');
</script>
</body>
</html>
