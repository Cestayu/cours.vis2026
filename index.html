<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cinema Box Office Explorer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e4e4e4;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #f39c12, #e74c3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            text-align: center;
            color: #95a5a6;
            margin-bottom: 30px;
            font-size: 1.2em;
        }

        .controls {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-item {
            display: flex;
            flex-direction: column;
        }

        label {
            color: #f39c12;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 0.9em;
        }

        select, input {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-size: 1em;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #f39c12;
            background: rgba(255,255,255,0.15);
        }

        option {
            background: #16213e;
            color: #fff;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(243,156,18,0.2), rgba(231,76,60,0.2));
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-label {
            font-size: 0.9em;
            color: #95a5a6;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #f39c12;
        }

        .viz-container {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .viz-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #f39c12;
        }

        #mainChart, #genreChart, #directorChart, #timelineChart {
            width: 100%;
            height: 500px;
        }

        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.9);
            color: #fff;
            padding: 12px;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
            max-width: 300px;
            border: 1px solid #f39c12;
        }

        .tooltip.active {
            opacity: 1;
        }

        .movie-card {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #f39c12;
            transition: all 0.3s ease;
        }

        .movie-card:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }

        .movie-title {
            font-size: 1.2em;
            color: #f39c12;
            margin-bottom: 5px;
        }

        .movie-info {
            color: #95a5a6;
            font-size: 0.9em;
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .axis text {
            fill: #95a5a6;
            font-size: 12px;
        }

        .axis line, .axis path {
            stroke: rgba(255,255,255,0.2);
        }

        .grid line {
            stroke: rgba(255,255,255,0.1);
        }

        button {
            background: linear-gradient(135deg, #f39c12, #e74c3c);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243,156,18,0.4);
        }

        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: linear-gradient(135deg, #f39c12, #e74c3c);
            border-color: #f39c12;
        }

        .tab:hover {
            background: rgba(255,255,255,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¬ Cinema Box Office</h1>
        <p class="subtitle">Explore movie data through genres, directors, and actors</p>

        <div class="controls">
            <div class="control-group">
                <div class="control-item">
                    <label for="yearFilter">Year</label>
                    <select id="yearFilter">
                        <option value="all">All Years</option>
                    </select>
                </div>
                <div class="control-item">
                    <label for="genreFilter">Genre</label>
                    <select id="genreFilter">
                        <option value="all">All Genres</option>
                    </select>
                </div>
                <div class="control-item">
                    <label for="directorFilter">Director</label>
                    <select id="directorFilter">
                        <option value="all">All Directors</option>
                    </select>
                </div>
                <div class="control-item">
                    <label for="actorFilter">Lead Actor</label>
                    <select id="actorFilter">
                        <option value="all">All Actors</option>
                    </select>
                </div>
            </div>
            <button onclick="resetFilters()">Reset All Filters</button>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Total Movies</div>
                <div class="stat-value" id="totalMovies">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Box Office</div>
                <div class="stat-value" id="totalBoxOffice">$0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Average Revenue</div>
                <div class="stat-value" id="avgRevenue">$0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Top Genre</div>
                <div class="stat-value" id="topGenre">-</div>
            </div>
        </div>

        <div class="tab-container">
            <div class="tab active" onclick="switchTab('overview')">Overview</div>
            <div class="tab" onclick="switchTab('genre')">By Genre</div>
            <div class="tab" onclick="switchTab('director')">By Director</div>
            <div class="tab" onclick="switchTab('timeline')">Timeline</div>
        </div>

        <div class="viz-container" id="overviewViz">
            <h2 class="viz-title">Box Office Performance</h2>
            <div id="mainChart"></div>
        </div>

        <div class="viz-container" id="genreViz" style="display: none;">
            <h2 class="viz-title">Genre Analysis</h2>
            <div id="genreChart"></div>
        </div>

        <div class="viz-container" id="directorViz" style="display: none;">
            <h2 class="viz-title">Top Directors by Revenue</h2>
            <div id="directorChart"></div>
        </div>

        <div class="viz-container" id="timelineViz" style="display: none;">
            <h2 class="viz-title">Box Office Timeline</h2>
            <div id="timelineChart"></div>
        </div>
    </div>

    <div class="tooltip"></div>

    <script>
        // Sample movie data - replace with your actual data
        const movieData = [
            {title: "The Avengers", year: 2012, boxOffice: 1518.8, genre: "Action", director: "Joss Whedon", actor: "Robert Downey Jr."},
            {title: "The Dark Knight Rises", year: 2012, boxOffice: 1084.9, genre: "Action", director: "Christopher Nolan", actor: "Christian Bale"},
            {title: "Skyfall", year: 2012, boxOffice: 1108.6, genre: "Action", director: "Sam Mendes", actor: "Daniel Craig"},
            {title: "The Hobbit", year: 2012, boxOffice: 1017.0, genre: "Fantasy", director: "Peter Jackson", actor: "Martin Freeman"},
            {title: "Frozen", year: 2013, boxOffice: 1280.8, genre: "Animation", director: "Chris Buck", actor: "Kristen Bell"},
            {title: "Iron Man 3", year: 2013, boxOffice: 1214.7, genre: "Action", director: "Shane Black", actor: "Robert Downey Jr."},
            {title: "Despicable Me 2", year: 2013, boxOffice: 970.8, genre: "Animation", director: "Pierre Coffin", actor: "Steve Carell"},
            {title: "Man of Steel", year: 2013, boxOffice: 668.0, genre: "Action", director: "Zack Snyder", actor: "Henry Cavill"},
            {title: "Gravity", year: 2013, boxOffice: 723.2, genre: "Sci-Fi", director: "Alfonso CuarÃ³n", actor: "Sandra Bullock"},
            {title: "Guardians of the Galaxy", year: 2014, boxOffice: 773.3, genre: "Action", director: "James Gunn", actor: "Chris Pratt"},
            {title: "Maleficent", year: 2014, boxOffice: 758.5, genre: "Fantasy", director: "Robert Stromberg", actor: "Angelina Jolie"},
            {title: "Transformers 4", year: 2014, boxOffice: 1104.1, genre: "Action", director: "Michael Bay", actor: "Mark Wahlberg"},
            {title: "The Hobbit: Battle", year: 2014, boxOffice: 956.0, genre: "Fantasy", director: "Peter Jackson", actor: "Martin Freeman"},
            {title: "Interstellar", year: 2014, boxOffice: 677.5, genre: "Sci-Fi", director: "Christopher Nolan", actor: "Matthew McConaughey"},
            {title: "Jurassic World", year: 2015, boxOffice: 1671.7, genre: "Action", director: "Colin Trevorrow", actor: "Chris Pratt"},
            {title: "Furious 7", year: 2015, boxOffice: 1516.0, genre: "Action", director: "James Wan", actor: "Vin Diesel"},
            {title: "Avengers: Age of Ultron", year: 2015, boxOffice: 1405.4, genre: "Action", director: "Joss Whedon", actor: "Robert Downey Jr."},
            {title: "Minions", year: 2015, boxOffice: 1159.4, genre: "Animation", director: "Kyle Balda", actor: "Sandra Bullock"},
            {title: "The Martian", year: 2015, boxOffice: 630.2, genre: "Sci-Fi", director: "Ridley Scott", actor: "Matt Damon"},
            {title: "Captain America: Civil War", year: 2016, boxOffice: 1153.3, genre: "Action", director: "Russo Brothers", actor: "Chris Evans"},
            {title: "Rogue One", year: 2016, boxOffice: 1056.1, genre: "Sci-Fi", director: "Gareth Edwards", actor: "Felicity Jones"},
            {title: "Finding Dory", year: 2016, boxOffice: 1028.6, genre: "Animation", director: "Andrew Stanton", actor: "Ellen DeGeneres"},
            {title: "Zootopia", year: 2016, boxOffice: 1023.8, genre: "Animation", director: "Byron Howard", actor: "Ginnifer Goodwin"},
            {title: "Doctor Strange", year: 2016, boxOffice: 677.7, genre: "Action", director: "Scott Derrickson", actor: "Benedict Cumberbatch"}
        ];

        let filteredData = [...movieData];
        let currentTab = 'overview';

        // Color scheme for genres
        const genreColors = {
            'Action': '#e74c3c',
            'Animation': '#3498db',
            'Fantasy': '#9b59b6',
            'Sci-Fi': '#1abc9c',
            'Drama': '#f39c12'
        };

        // Initialize
        function init() {
            populateFilters();
            updateStats();
            drawMainChart();
            drawGenreChart();
            drawDirectorChart();
            drawTimelineChart();
        }

        function populateFilters() {
            const years = [...new Set(movieData.map(d => d.year))].sort();
            const genres = [...new Set(movieData.map(d => d.genre))].sort();
            const directors = [...new Set(movieData.map(d => d.director))].sort();
            const actors = [...new Set(movieData.map(d => d.actor))].sort();

            const yearSelect = document.getElementById('yearFilter');
            years.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            });

            const genreSelect = document.getElementById('genreFilter');
            genres.forEach(genre => {
                const option = document.createElement('option');
                option.value = genre;
                option.textContent = genre;
                genreSelect.appendChild(option);
            });

            const directorSelect = document.getElementById('directorFilter');
            directors.forEach(director => {
                const option = document.createElement('option');
                option.value = director;
                option.textContent = director;
                directorSelect.appendChild(option);
            });

            const actorSelect = document.getElementById('actorFilter');
            actors.forEach(actor => {
                const option = document.createElement('option');
                option.value = actor;
                option.textContent = actor;
                actorSelect.appendChild(option);
            });

            // Add event listeners
            document.getElementById('yearFilter').addEventListener('change', applyFilters);
            document.getElementById('genreFilter').addEventListener('change', applyFilters);
            document.getElementById('directorFilter').addEventListener('change', applyFilters);
            document.getElementById('actorFilter').addEventListener('change', applyFilters);
        }

        function applyFilters() {
            const year = document.getElementById('yearFilter').value;
            const genre = document.getElementById('genreFilter').value;
            const director = document.getElementById('directorFilter').value;
            const actor = document.getElementById('actorFilter').value;

            filteredData = movieData.filter(d => {
                return (year === 'all' || d.year == year) &&
                       (genre === 'all' || d.genre === genre) &&
                       (director === 'all' || d.director === director) &&
                       (actor === 'all' || d.actor === actor);
            });

            updateStats();
            drawMainChart();
            drawGenreChart();
            drawDirectorChart();
            drawTimelineChart();
        }

        function resetFilters() {
            document.getElementById('yearFilter').value = 'all';
            document.getElementById('genreFilter').value = 'all';
            document.getElementById('directorFilter').value = 'all';
            document.getElementById('actorFilter').value = 'all';
            applyFilters();
        }

        function updateStats() {
            const total = filteredData.length;
            const totalRevenue = d3.sum(filteredData, d => d.boxOffice);
            const avgRevenue = totalRevenue / total;
            
            const genreCounts = d3.rollup(filteredData, v => v.length, d => d.genre);
            const topGenre = Array.from(genreCounts.entries()).sort((a, b) => b[1] - a[1])[0]?.[0] || '-';

            document.getElementById('totalMovies').textContent = total;
            document.getElementById('totalBoxOffice').textContent = '$' + totalRevenue.toFixed(1) + 'B';
            document.getElementById('avgRevenue').textContent = '$' + avgRevenue.toFixed(1) + 'M';
            document.getElementById('topGenre').textContent = topGenre;
        }

        function drawMainChart() {
            d3.select('#mainChart').selectAll('*').remove();

            const margin = {top: 40, right: 100, bottom: 60, left: 60};
            const width = document.getElementById('mainChart').clientWidth - margin.left - margin.right;
            const height = 500 - margin.top - margin.bottom;

            const svg = d3.select('#mainChart')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const x = d3.scaleLinear()
                .domain([d3.min(filteredData, d => d.year) - 0.5, d3.max(filteredData, d => d.year) + 0.5])
                .range([0, width]);

            const y = d3.scaleLinear()
                .domain([0, d3.max(filteredData, d => d.boxOffice) * 1.1])
                .range([height, 0]);

            // Grid
            svg.append('g')
                .attr('class', 'grid')
                .call(d3.axisLeft(y).tickSize(-width).tickFormat(''));

            // Axes
            svg.append('g')
                .attr('class', 'axis')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(x).tickFormat(d3.format('d')));

            svg.append('g')
                .attr('class', 'axis')
                .call(d3.axisLeft(y).tickFormat(d => '$' + d + 'M'));

            // Circles
            const tooltip = d3.select('.tooltip');

            svg.selectAll('circle')
                .data(filteredData)
                .join('circle')
                .attr('cx', d => x(d.year))
                .attr('cy', d => y(d.boxOffice))
                .attr('r', 0)
                .attr('fill', d => genreColors[d.genre] || '#95a5a6')
                .attr('opacity', 0.7)
                .on('mouseover', function(event, d) {
                    d3.select(this).attr('r', 12).attr('opacity', 1);
                    tooltip.classed('active', true)
                        .html(`
                            <strong>${d.title}</strong><br>
                            Year: ${d.year}<br>
                            Box Office: $${d.boxOffice}M<br>
                            Genre: ${d.genre}<br>
                            Director: ${d.director}<br>
                            Lead Actor: ${d.actor}
                        `)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px');
                })
                .on('mouseout', function() {
                    d3.select(this).attr('r', 8).attr('opacity', 0.7);
                    tooltip.classed('active', false);
                })
                .transition()
                .duration(800)
                .attr('r', 8);

            // Legend
            const legend = svg.append('g')
                .attr('transform', `translate(${width - 80}, 20)`);

            Object.entries(genreColors).forEach(([genre, color], i) => {
                const g = legend.append('g')
                    .attr('transform', `translate(0, ${i * 25})`);

                g.append('rect')
                    .attr('width', 18)
                    .attr('height', 18)
                    .attr('fill', color);

                g.append('text')
                    .attr('x', 24)
                    .attr('y', 14)
                    .text(genre)
                    .style('fill', '#95a5a6')
                    .style('font-size', '12px');
            });
        }

        function drawGenreChart() {
            d3.select('#genreChart').selectAll('*').remove();

            const genreData = Array.from(d3.rollup(filteredData, 
                v => ({count: v.length, revenue: d3.sum(v, d => d.boxOffice)}), 
                d => d.genre
            )).map(([genre, data]) => ({genre, ...data}));

            const margin = {top: 20, right: 30, bottom: 100, left: 80};
            const width = document.getElementById('genreChart').clientWidth - margin.left - margin.right;
            const height = 500 - margin.top - margin.bottom;

            const svg = d3.select('#genreChart')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const x = d3.scaleBand()
                .domain(genreData.map(d => d.genre))
                .range([0, width])
                .padding(0.3);

            const y = d3.scaleLinear()
                .domain([0, d3.max(genreData, d => d.revenue) * 1.1])
                .range([height, 0]);

            svg.append('g')
                .attr('transform', `translate(0,${height})`)
                .attr('class', 'axis')
                .call(d3.axisBottom(x))
                .selectAll('text')
                .attr('transform', 'rotate(-45)')
                .style('text-anchor', 'end');

            svg.append('g')
                .attr('class', 'axis')
                .call(d3.axisLeft(y).tickFormat(d => '$' + d + 'M'));

            const tooltip = d3.select('.tooltip');

            svg.selectAll('rect')
                .data(genreData)
                .join('rect')
                .attr('x', d => x(d.genre))
                .attr('width', x.bandwidth())
                .attr('y', height)
                .attr('height', 0)
                .attr('fill', d => genreColors[d.genre] || '#95a5a6')
                .on('mouseover', function(event, d) {
                    d3.select(this).attr('opacity', 1);
                    tooltip.classed('active', true)
                        .html(`
                            <strong>${d.genre}</strong><br>
                            Movies: ${d.count}<br>
                            Total Revenue: $${d.revenue.toFixed(1)}M<br>
                            Avg Revenue: $${(d.revenue/d.count).toFixed(1)}M
                        `)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px');
                })
                .on('mouseout', function() {
                    d3.select(this).attr('opacity', 0.8);
                    tooltip.classed('active', false);
                })
                .transition()
                .duration(800)
                .attr('y', d => y(d.revenue))
                .attr('height', d => height - y(d.revenue))
                .attr('opacity', 0.8);
        }

        function drawDirectorChart() {
            d3.select('#directorChart').selectAll('*').remove();

            const directorData = Array.from(d3.rollup(filteredData, 
                v => ({count: v.length, revenue: d3.sum(v, d => d.boxOffice)}), 
                d => d.director
            )).map(([director, data]) => ({director, ...data}))
              .sort((a, b) => b.revenue - a.revenue)
              .slice(0, 10);

            const margin = {top: 20, right: 30, bottom: 60, left: 200};
            const width = document.getElementById('directorChart').clientWidth - margin.left - margin.right;
            const height = 500 - margin.top - margin.bottom;

            const svg = d3.select('#directorChart')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const x = d3.scaleLinear()
                .domain([0, d3.max(directorData, d => d.revenue) * 1.1])
                .range([0, width]);

            const y = d3.scaleBand()
                .domain(directorData.map(d => d.director))
                .range([0, height])
                .padding(0.2);

            svg.append('g')
                .attr('class', 'axis')
                .call(d3.axisLeft(y));

            svg.append('g')
                .attr('class', 'axis')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(x).tickFormat(d => '$' + d + 'M'));

            const tooltip = d3.select('.tooltip');

            svg.selectAll('rect')
                .data(directorData)
                .join('rect')
                .attr('y', d => y(d.director))
                .attr('height', y.bandwidth())
                .attr('x', 0)
                .attr('width', 0)
                .attr('fill', '#f39c12')
                .on('mouseover', function(event, d) {
                    d3.select(this).attr('fill', '#e74c3c');
                    tooltip.classed('active', true)
                        .html(`
                            <strong>${d.director}</strong><br>
                            Movies: ${d.count}<br>
                            Total Revenue: $${d.revenue.toFixed(1)}M<br>
                            Avg per Movie: $${(d.revenue/d.count).toFixed(1)}M
                        `)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px');
                })
                .on('mouseout', function() {
                    d3.select(this).attr('fill', '#f39c12');
                    tooltip.classed('active', false);
                })
                .transition()
                .duration(800)
                .attr('width', d => x(d.revenue));
        }

        function drawTimelineChart() {
            d3.select('#timelineChart').selectAll('*').remove();

            const yearData = Array.from(d3.rollup(filteredData, 
                v => ({count: v.length, revenue: d3.sum(v, d => d.boxOffice)}), 
                d => d.year
            )).map(([year, data]) => ({year, ...data}))
              .sort((a, b) => a.year - b.year);

            const margin = {top: 20, right: 30, bottom: 60, left: 80};
            const width = document.getElementById('timelineChart').clientWidth - margin.left - margin.right;
            const height = 500 - margin.top - margin.bottom;

            const svg = d3.select('#timelineChart')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const x = d3.scaleLinear()
                .domain(d3.extent(yearData, d => d.year))
                .range([0, width]);

            const y = d3.scaleLinear()
                .domain([0, d3.max(yearData, d => d.revenue) * 1.1])
                .range([height, 0]);

            // Grid
            svg.append('g')
                .attr('class', 'grid')
                .call(d3.axisLeft(y).tickSize(-width).tickFormat(''));

            // Axes
            svg.append('g')
                .attr('class', 'axis')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(x).tickFormat(d3.format('d')));

            svg.append('g')
                .attr('class', 'axis')
                .call(d3.axisLeft(y).tickFormat(d => '
             + d + 'M'));

            // Line
            const line = d3.line()
                .x(d => x(d.year))
                .y(d => y(d.revenue))
                .curve(d3.curveMonotoneX);

            svg.append('path')
                .datum(yearData)
                .attr('fill', 'none')
                .attr('stroke', '#f39c12')
                .attr('stroke-width', 3)
                .attr('d', line);

            // Area
            const area = d3.area()
                .x(d => x(d.year))
                .y0(height)
                .y1(d => y(d.revenue))
                .curve(d3.curveMonotoneX);

            svg.append('path')
                .datum(yearData)
                .attr('fill', 'url(#gradient)')
                .attr('d', area);

            // Gradient
            const gradient = svg.append('defs')
                .append('linearGradient')
                .attr('id', 'gradient')
                .attr('x1', '0%')
                .attr('y1', '0%')
                .attr('x2', '0%')
                .attr('y2', '100%');

            gradient.append('stop')
                .attr('offset', '0%')
                .attr('stop-color', '#f39c12')
                .attr('stop-opacity', 0.5);

            gradient.append('stop')
                .attr('offset', '100%')
                .attr('stop-color', '#f39c12')
                .attr('stop-opacity', 0);

            // Points
            const tooltip = d3.select('.tooltip');

            svg.selectAll('circle')
                .data(yearData)
                .join('circle')
                .attr('cx', d => x(d.year))
                .attr('cy', d => y(d.revenue))
                .attr('r', 6)
                .attr('fill', '#f39c12')
                .attr('stroke', '#1a1a2e')
                .attr('stroke-width', 2)
                .on('mouseover', function(event, d) {
                    d3.select(this).attr('r', 10);
                    tooltip.classed('active', true)
                        .html(`
                            <strong>${d.year}</strong><br>
                            Movies Released: ${d.count}<br>
                            Total Revenue: ${d.revenue.toFixed(1)}M
                        `)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px');
                })
                .on('mouseout', function() {
                    d3.select(this).attr('r', 6);
                    tooltip.classed('active', false);
                });
        }

        function switchTab(tab) {
            currentTab = tab;
            
            // Update tab styles
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // Hide all viz containers
            document.getElementById('overviewViz').style.display = 'none';
            document.getElementById('genreViz').style.display = 'none';
            document.getElementById('directorViz').style.display = 'none';
            document.getElementById('timelineViz').style.display = 'none';

            // Show selected viz
            switch(tab) {
                case 'overview':
                    document.getElementById('overviewViz').style.display = 'block';
                    break;
                case 'genre':
                    document.getElementById('genreViz').style.display = 'block';
                    break;
                case 'director':
                    document.getElementById('directorViz').style.display = 'block';
                    break;
                case 'timeline':
                    document.getElementById('timelineViz').style.display = 'block';
                    break;
            }
        }

        // Initialize on load
        init();
