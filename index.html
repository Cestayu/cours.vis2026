<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cinema Box Office Explorer</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background:#fafafa; color:#1a1a1a; min-height:100vh; padding:20px; }
    .container { max-width:1400px; margin:0 auto; }
    h1 { text-align:center; font-size:2.5em; margin-bottom:8px; color:#1a1a1a; font-weight:300; letter-spacing:-1px; }
    .subtitle { text-align:center; color:#666; margin-bottom:28px; font-size:0.95em; font-weight:400; }
    .lang-switch { text-align:center; margin-bottom:20px; }
    .lang-btn { background:transparent; border:1px solid #e0e0e0; padding:8px 20px; margin:0 5px; border-radius:20px; cursor:pointer; font-size:0.85em; font-weight:500; color:#666; transition:all 0.2s; }
    .lang-btn.active { background:#1a1a1a; color:#fff; border-color:#1a1a1a; }
    .lang-btn:hover { border-color:#1a1a1a; }
    .controls { background:#fff; border-radius:12px; padding:24px; margin-bottom:20px; border:1px solid #e0e0e0; box-shadow:0 2px 8px rgba(0,0,0,0.04); }
    .control-group { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:16px; margin-bottom:12px; }
    label { color:#1a1a1a; margin-bottom:8px; font-weight:500; font-size:0.85em; display:block; }
    select,input { padding:10px 14px; border-radius:8px; border:1px solid #e0e0e0; background:#fafafa; color:#1a1a1a; font-size:0.9em; transition:all 0.2s; width:100%; }
    select:focus,input:focus { outline:none; border-color:#1a1a1a; background:#fff; }
    .stats-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:16px; margin:18px 0; }
    .stat-card { background:#fff; border-radius:12px; padding:20px; border:1px solid #e0e0e0; box-shadow:0 2px 8px rgba(0,0,0,0.04); }
    .stat-label { font-size:0.8em; color:#666; margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px; font-weight:500; }
    .stat-value { font-size:1.8em; font-weight:300; color:#1a1a1a; }
    .viz-container { background:#fff; border-radius:12px; padding:24px; margin-bottom:20px; border:1px solid #e0e0e0; box-shadow:0 2px 8px rgba(0,0,0,0.04); }
    .viz-title { font-size:1.2em; margin-bottom:18px; color:#1a1a1a; text-align:center; font-weight:500; letter-spacing:-0.5px; }
    .tooltip { position:absolute; background:rgba(26,26,26,0.95); color:#fff; padding:12px; border-radius:8px; pointer-events:none; opacity:0; transition:opacity 0.15s; font-size:0.85em; max-width:320px; box-shadow:0 6px 24px rgba(0,0,0,0.3); z-index:1000; }
    .tooltip.active { opacity:1; }
    .tooltip-title { font-size:1em; color:#fff; margin-bottom:6px; font-weight:500; }
    .movie-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:20px; }
    .movie-card { background:#fff; border-radius:12px; overflow:hidden; transition:all 0.3s; border:1px solid #e0e0e0; cursor:pointer; }
    .movie-card:hover { transform:translateY(-4px); border-color:#1a1a1a; box-shadow:0 12px 24px rgba(0,0,0,0.1); }
    .movie-poster { width:100%; height:360px; object-fit:cover; display:block; }
    .movie-info { padding:16px; }
    .movie-title { font-size:1.05em; color:#1a1a1a; margin-bottom:8px; font-weight:500; }
    .movie-details { color:#666; font-size:0.85em; line-height:1.6; }
    .tab-container { display:flex; gap:8px; margin-bottom:20px; flex-wrap:wrap; justify-content:center; }
    .tab { padding:10px 20px; background:#fff; border:1px solid #e0e0e0; border-radius:20px; cursor:pointer; color:#666; font-weight:500; font-size:0.85em; transition:all 0.2s; }
    .tab.active { background:#1a1a1a; border-color:#1a1a1a; color:#fff; }
    .tab:hover { border-color:#1a1a1a; }
    .axis text { fill:#666; font-size:11px; }
    .axis line,.axis path { stroke:#e0e0e0; }
    .grid line { stroke:rgba(0,0,0,0.05); }
    button { background:#1a1a1a; color:#fff; border:none; padding:10px 20px; border-radius:20px; cursor:pointer; font-size:0.85em; font-weight:500; transition:all 0.2s; }
    button:hover { transform:translateY(-1px); box-shadow:0 4px 12px rgba(0,0,0,0.15); }
    @media (max-width:560px){ 
        .movie-poster{height:280px} 
        h1{font-size:2em;}
        .control-group{grid-template-columns:1fr;}
    }
</style>
</head>
<body>
<div class="container">
    <h1>Cinema Box Office</h1>
    <p class="subtitle">Explore the highest-grossing films</p>
    
    <div class="lang-switch">
        <button class="lang-btn active" onclick="setLanguage('en')">English</button>
        <button class="lang-btn" onclick="setLanguage('fr')">Français</button>
    </div>

    <div class="controls">
        <div class="control-group">
            <div>
                <label for="yearFilter">Year</label>
                <select id="yearFilter"><option value="all">All Years</option></select>
            </div>
            <div>
                <label for="genreFilter">Genre</label>
                <select id="genreFilter"><option value="all">All Genres</option></select>
            </div>
            <div>
                <label for="directorFilter">Director</label>
                <select id="directorFilter"><option value="all">All Directors</option></select>
            </div>
            <div>
                <label for="actorFilter">Lead Actor</label>
                <select id="actorFilter"><option value="all">All Actors</option></select>
            </div>
        </div>
        <div style="display:flex; gap:12px; justify-content:flex-end;">
            <button onclick="resetFilters()">Reset Filters</button>
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card"><div class="stat-label">Total Movies</div><div class="stat-value" id="totalMovies">0</div></div>
        <div class="stat-card"><div class="stat-label">Total Box Office</div><div class="stat-value" id="totalBoxOffice">$0B</div></div>
        <div class="stat-card"><div class="stat-label">Average Revenue</div><div class="stat-value" id="avgRevenue">$0M</div></div>
        <div class="stat-card"><div class="stat-label">Top Genre</div><div class="stat-value" id="topGenre">-</div></div>
    </div>

    <div class="tab-container">
        <div class="tab active" onclick="switchTab(event,'overview')">Overview</div>
        <div class="tab" onclick="switchTab(event,'genre')">Genre Analysis</div>
        <div class="tab" onclick="switchTab(event,'director')">Directors</div>
        <div class="tab" onclick="switchTab(event,'timeline')">Timeline</div>
        <div class="tab" onclick="switchTab(event,'gallery')">Movie Gallery</div>
    </div>

    <div class="viz-container" id="overviewViz">
        <h2 class="viz-title">Box Office Distribution</h2>
        <div id="mainChart" style="width:100%; min-height:480px;"></div>
    </div>

    <div class="viz-container" id="genreViz" style="display:none;">
        <h2 class="viz-title">Revenue by Genre</h2>
        <div id="genreChart" style="width:100%; min-height:480px;"></div>
    </div>

    <div class="viz-container" id="directorViz" style="display:none;">
        <h2 class="viz-title">Top Directors by Revenue</h2>
        <div id="directorChart" style="width:100%; min-height:480px;"></div>
    </div>

    <div class="viz-container" id="timelineViz" style="display:none;">
        <h2 class="viz-title">Box Office Evolution</h2>
        <div id="timelineChart" style="width:100%; min-height:480px;"></div>
    </div>

    <div class="viz-container" id="galleryViz" style="display:none;">
        <h2 class="viz-title">Movie Gallery</h2>
        <div id="movieGrid" class="movie-grid"></div>
    </div>
</div>

<div class="tooltip" id="tooltip"></div>

<script>
const movieData = [
  {year:2013,title:"Frozen",boxOffice:1280.802282,genre:"Animation",director:"Chris Buck, Jennifer Lee",actor:"Kristen Bell",poster:"https://image.tmdb.org/t/p/w500/kgwjIb0CQ7CysYR5w3CZ0nVNfnQ.jpg"},
  {year:2013,title:"Iron Man 3",boxOffice:1214.811252,genre:"Action",director:"Shane Black",actor:"Robert Downey Jr.",poster:"https://image.tmdb.org/t/p/w500/qhPtAc1TKbMPqNvcdXSOn9Bn7hZ.jpg"},
  {year:2013,title:"Despicable Me 2",boxOffice:970.766005,genre:"Animation",director:"Pierre Coffin, Chris Renaud",actor:"Steve Carell",poster:"https://image.tmdb.org/t/p/w500/5Fh4NdoEnCjCK9wLjdJ9DJNFl2b.jpg"},
  {year:2013,title:"The Hobbit: The Desolation of Smaug",boxOffice:958.366855,genre:"Fantasy",director:"Peter Jackson",actor:"Martin Freeman",poster:"https://image.tmdb.org/t/p/w500/xQYiXsmeQ7Gu4WkZe2XP6cOGKnd.jpg"},
  {year:2013,title:"The Hunger Games: Catching Fire",boxOffice:865.011746,genre:"Science Fiction",director:"Francis Lawrence",actor:"Jennifer Lawrence",poster:"https://image.tmdb.org/t/p/w500/v9qVkyS58WHdfrcEq0dxUJFKS9n.jpg"},

  {year:2014,title:"Transformers: Age of Extinction",boxOffice:1104.054072,genre:"Science Fiction",director:"Michael Bay",actor:"Mark Wahlberg",poster:"https://image.tmdb.org/t/p/w500/jyzrfx2WaeY60kYZpPYepSjGz4S.jpg"},
  {year:2014,title:"The Hobbit: The Battle of the Five Armies",boxOffice:962.201338,genre:"Fantasy",director:"Peter Jackson",actor:"Martin Freeman",poster:"https://image.tmdb.org/t/p/w500/9zRzFJuaj0CHIOhAkcCcFTvyu4b.jpg"},
  {year:2014,title:"Guardians of the Galaxy",boxOffice:773.350147,genre:"Science Fiction",director:"James Gunn",actor:"Chris Pratt",poster:"https://image.tmdb.org/t/p/w500/r7vmZjiyZw9rpJMQJdXpjgiCOk9.jpg"},
  {year:2014,title:"Maleficent",boxOffice:758.536735,genre:"Fantasy",director:"Robert Stromberg",actor:"Angelina Jolie",poster:"https://image.tmdb.org/t/p/w500/bDG3yei6AJlEAK3A5wN7RwFXQ7V.jpg"},
  {year:2014,title:"The Hunger Games: Mockingjay - Part 1",boxOffice:755.356711,genre:"Science Fiction",director:"Francis Lawrence",actor:"Jennifer Lawrence",poster:"https://image.tmdb.org/t/p/w500/4PwNJHBPqwb7We2zDbQdXxFVqd.jpg"},

  {year:2015,title:"Star Wars: The Force Awakens",boxOffice:2068.223624,genre:"Science Fiction",director:"J. J. Abrams",actor:"Harrison Ford",poster:"https://image.tmdb.org/t/p/w500/wqnLdwVXoBjKibFRR5U3y0aDUhs.jpg"},
  {year:2015,title:"Jurassic World",boxOffice:1671.537444,genre:"Science Fiction",director:"Colin Trevorrow",actor:"Chris Pratt",poster:"https://image.tmdb.org/t/p/w500/jhn83yCCxLxlMXhq2yrp2gOYvri.jpg"},
  {year:2015,title:"Furious 7",boxOffice:1515.341399,genre:"Action",director:"James Wan",actor:"Vin Diesel",poster:"https://image.tmdb.org/t/p/w500/dCgm7efXDmiABSdWDHBDBx2jwmn.jpg"},
  {year:2015,title:"Avengers: Age of Ultron",boxOffice:1402.80954,genre:"Action",director:"Joss Whedon",actor:"Robert Downey Jr.",poster:"https://image.tmdb.org/t/p/w500/4ssDuvEDkSArWEdyBl2X5EHvYKU.jpg"},
  {year:2015,title:"Minions",boxOffice:1159.444662,genre:"Animation",director:"Pierre Coffin, Kyle Balda",actor:"Sandra Bullock",poster:"https://image.tmdb.org/t/p/w500/s5uMY8ooGRZOL0oe4sIvnlTsYQO.jpg"},

  {year:2016,title:"Captain America: Civil War",boxOffice:1153.337496,genre:"Action",director:"Anthony & Joe Russo",actor:"Chris Evans",poster:"https://image.tmdb.org/t/p/w500/rAGiXaUfPu0D38NzvDkJPXJBeBf.jpg"},
  {year:2016,title:"Rogue One: A Star Wars Story",boxOffice:1056.057273,genre:"Science Fiction",director:"Gareth Edwards",actor:"Felicity Jones",poster:"https://image.tmdb.org/t/p/w500/i0yw1mFbB7sNGHCs7EXZPzFkdA1.jpg"},
  {year:2016,title:"Finding Dory",boxOffice:1028.570889,genre:"Animation",director:"Andrew Stanton",actor:"Ellen DeGeneres",poster:"https://image.tmdb.org/t/p/w500/yFjVlsJmEMacU0BNUwdGZlo2ixq.jpg"},
  {year:2016,title:"Zootopia",boxOffice:1025.521689,genre:"Animation",director:"Byron Howard, Rich Moore",actor:"Ginnifer Goodwin",poster:"https://image.tmdb.org/t/p/w500/hlK0e0wAQ3VLuJcsfIYPvb4JVud.jpg"},
  {year:2016,title:"The Jungle Book",boxOffice:967.724775,genre:"Adventure",director:"Jon Favreau",actor:"Neel Sethi",poster:"https://image.tmdb.org/t/p/w500/vIu4cIVlmUCPPCgPKDJ0J2CcwfO.jpg"},

  {year:2017,title:"Star Wars: The Last Jedi",boxOffice:1334.407706,genre:"Science Fiction",director:"Rian Johnson",actor:"Mark Hamill",poster:"https://image.tmdb.org/t/p/w500/kOVEVeg59E0wsnXmF9nrh6OmWII.jpg"},
  {year:2017,title:"Beauty and the Beast",boxOffice:1266.115964,genre:"Fantasy",director:"Bill Condon",actor:"Emma Watson",poster:"https://image.tmdb.org/t/p/w500/hKegSKIDep2ewJWPUQD7u0KqFIp.jpg"},
  {year:2017,title:"The Fate of the Furious",boxOffice:1236.005118,genre:"Action",director:"F. Gary Gray",actor:"Vin Diesel",poster:"https://image.tmdb.org/t/p/w500/dImWM7GJqryWJO9LHa3XQ8DD5NH.jpg"},
  {year:2017,title:"Despicable Me 3",boxOffice:1034.800131,genre:"Animation",director:"Kyle Balda",actor:"Steve Carell",poster:"https://image.tmdb.org/t/p/w500/6t3YwxJ7UK3N8i16IGmt5IyaHii.jpg"},
  {year:2017,title:"Jumanji: Welcome to the Jungle",boxOffice:962.102237,genre:"Adventure",director:"Jake Kasdan",actor:"Dwayne Johnson",poster:"https://image.tmdb.org/t/p/w500/bXrZ5iHBEjH7WMidbUDQ0U2xbmr.jpg"},

  {year:2018,title:"Avengers: Infinity War",boxOffice:2048.359754,genre:"Action",director:"Anthony & Joe Russo",actor:"Robert Downey Jr.",poster:"https://image.tmdb.org/t/p/w500/7WsyChQLEftFiDOVTGkv3hFpyyt.jpg"},
  {year:2018,title:"Black Panther",boxOffice:1347.597973,genre:"Action",director:"Ryan Coogler",actor:"Chadwick Boseman",poster:"https://image.tmdb.org/t/p/w500/uxzzxijgPIY7slzFvMotPv8wjKA.jpg"},
  {year:2018,title:"Jurassic World: Fallen Kingdom",boxOffice:1308.467944,genre:"Science Fiction",director:"J. A. Bayona",actor:"Chris Pratt",poster:"https://image.tmdb.org/t/p/w500/c9XxwwhPHdaImA2f1WEfEsbhaFB.jpg"},
  {year:2018,title:"Incredibles 2",boxOffice:1242.805359,genre:"Animation",director:"Brad Bird",actor:"Craig T. Nelson",poster:"https://image.tmdb.org/t/p/w500/9lFKBtbrXOZCf9sSuYkhvpTrCBQ.jpg"},
  {year:2018,title:"Aquaman",boxOffice:1148.528393,genre:"Action",director:"James Wan",actor:"Jason Momoa",poster:"https://image.tmdb.org/t/p/w500/5Kg76ldv7VxeX9YlcQXiowHgdX6.jpg"},

  {year:2019,title:"Avengers: Endgame",boxOffice:2797.501328,genre:"Action",director:"Anthony & Joe Russo",actor:"Robert Downey Jr.",poster:"https://image.tmdb.org/t/p/w500/or06FN3Dka5tukK1e9sl16pB3iy.jpg"},
  {year:2019,title:"The Lion King",boxOffice:1656.943394,genre:"Animation",director:"Jon Favreau",actor:"Donald Glover",poster:"https://image.tmdb.org/t/p/w500/2bXbqYdUdNVa8VIWXVfclP2ICtT.jpg"},
  {year:2019,title:"Frozen II",boxOffice:1450.026933,genre:"Animation",director:"Chris Buck, Jennifer Lee",actor:"Idina Menzel",poster:"https://image.tmdb.org/t/p/w500/pjeMs3yqRmFL3giJy4PMXWZTTPa.jpg"},
  {year:2019,title:"Spider-Man: Far From Home",boxOffice:1131.927996,genre:"Action",director:"Jon Watts",actor:"Tom Holland",poster:"https://image.tmdb.org/t/p/w500/4q2NNj4S5dG2RLF9CpXsej7yXl.jpg"},
  {year:2019,title:"Captain Marvel",boxOffice:1128.462972,genre:"Action",director:"Anna Boden, Ryan Fleck",actor:"Brie Larson",poster:"https://image.tmdb.org/t/p/w500/AtsgWhDnHTq68L0lLsUrCnM7TjG.jpg"},

  {year:2020,title:"The Eight Hundred",boxOffice:461.421559,genre:"War",director:"Guan Hu",actor:"",poster:"https://image.tmdb.org/t/p/w500/kSf9svfL2WrKeuK8W08xeR5lTn8.jpg"},
  {year:2020,title:"Bad Boys for Life",boxOffice:426.505244,genre:"Action",director:"Adil El Arbi, Bilall Fallah",actor:"Will Smith",poster:"https://image.tmdb.org/t/p/w500/y95lQLnuNKdPAzw9F9Ab8kJ80c3.jpg"},
  {year:2020,title:"My People, My Homeland",boxOffice:422.39082,genre:"Comedy",director:"Collectif",actor:"",poster:"https://image.tmdb.org/t/p/w500/6DPFmr5w1IvjT28HmLlK1bBzB56.jpg"},
  {year:2020,title:"Tenet",boxOffice:365.304105,genre:"Science Fiction",director:"Christopher Nolan",actor:"John David Washington",poster:"https://image.tmdb.org/t/p/w500/k68nPLbIST6NP96JmTxmZijEvCA.jpg"},
  {year:2020,title:"Sonic the Hedgehog",boxOffice:319.715683,genre:"Adventure",director:"Jeff Fowler",actor:"Ben Schwartz",poster:"https://image.tmdb.org/t/p/w500/aQvJ5WPzZgYVDrxLX4R6cLJCEaQ.jpg"},

  {year:2021,title:"Spider-Man: No Way Home",boxOffice:1921.847111,genre:"Action",director:"Jon Watts",actor:"Tom Holland",poster:"https://image.tmdb.org/t/p/w500/1g0dhYtq4irTY1GPXvft6k4YLjm.jpg"},
  {year:2021,title:"The Battle at Lake Changjin",boxOffice:902.548476,genre:"War",director:"Chen Kaige",actor:"",poster:"https://image.tmdb.org/t/p/w500/9Yw8Kddk26gPASq2fDpvCDq93EZ.jpg"},
  {year:2021,title:"Hi, Mom",boxOffice:841.674419,genre:"Drama",director:"Jia Ling",actor:"",poster:"https://image.tmdb.org/t/p/w500/hAs6GHHqcNrzcHL26mxp0H0qqiN.jpg"},
  {year:2021,title:"No Time to Die",boxOffice:774.153007,genre:"Action",director:"Cary Joji Fukunaga",actor:"Daniel Craig",poster:"https://image.tmdb.org/t/p/w500/iUgygt3fscRoKWCV1d0C7FbM9TP.jpg"},
  {year:2021,title:"F9",boxOffice:726.229501,genre:"Action",director:"Justin Lin",actor:"Vin Diesel",poster:"https://image.tmdb.org/t/p/w500/bOFaAXmWWXC3Rbv4u4uM9ZSzRXP.jpg"},

  {year:2022,title:"Avatar: The Way of Water",boxOffice:2320.250281,genre:"Science Fiction",director:"James Cameron",actor:"Sam Worthington",poster:"https://image.tmdb.org/t/p/w500/t6HIqrRAclMCA60NsSmeqe9RmNV.jpg"},
  {year:2022,title:"Top Gun: Maverick",boxOffice:1495.696292,genre:"Action",director:"Joseph Kosinski",actor:"Tom Cruise",poster:"https://image.tmdb.org/t/p/w500/62HCnUTziyWcpDaBO2i1DX17ljH.jpg"},
  {year:2022,title:"Jurassic World Dominion",boxOffice:1001.97808,genre:"Science Fiction",director:"Colin Trevorrow",actor:"Chris Pratt",poster:"https://image.tmdb.org/t/p/w500/kAVRgw7GgK1CfYEJq8ME6EvRIgU.jpg"},
  {year:2022,title:"Doctor Strange in the Multiverse of Madness",boxOffice:955.775804,genre:"Action",director:"Sam Raimi",actor:"Benedict Cumberbatch",poster:"https://image.tmdb.org/t/p/w500/9Gtg2DzBhmYamXBS1hKAhiwbBKS.jpg"},
  {year:2022,title:"Minions: The Rise of Gru",boxOffice:940.203765,genre:"Animation",director:"Kyle Balda",actor:"Steve Carell",poster:"https://image.tmdb.org/t/p/w500/wKiOkZTN9lUUUNZLmtnwubZYONg.jpg"},

  {year:2023,title:"Barbie",boxOffice:1445.638421,genre:"Comedy",director:"Greta Gerwig",actor:"Margot Robbie",poster:"https://image.tmdb.org/t/p/w500/iuFNMS8U5cb6xfzi51Dbkovj7vM.jpg"},
  {year:2023,title:"The Super Mario Bros. Movie",boxOffice:1361.992475,genre:"Animation",director:"Aaron Horvath, Michael Jelenic",actor:"Chris Pratt",poster:"https://image.tmdb.org/t/p/w500/qNBAXBIQlnOThrVvA6mA2B5ggV6.jpg"},
  {year:2023,title:"Oppenheimer",boxOffice:975.440031,genre:"Drama",director:"Christopher Nolan",actor:"Cillian Murphy",poster:"https://image.tmdb.org/t/p/w500/8Gxv8gSFCU0XGDykEGv7zR1n2ua.jpg"},
  {year:2023,title:"Guardians of the Galaxy Vol. 3",boxOffice:845.555777,genre:"Action",director:"James Gunn",actor:"Chris Pratt",poster:"https://image.tmdb.org/t/p/w500/r2J02Z2OpNTctfOSN1Ydgii51I3.jpg"},
  {year:2023,title:"Fast X",boxOffice:704.875015,genre:"Action",director:"Louis Leterrier",actor:"Vin Diesel",poster:"https://image.tmdb.org/t/p/w500/fiVW06jE7z9YnO4trhaMEdclSiC.jpg"}
];

let filteredData = [...movieData];
let currentTab = 'overview';
let currentLang = 'en';

const translations = {
  en: {
    subtitle: "Explore the highest-grossing films",
    year: "Year",
    genre: "Genre",
    director: "Director",
    leadActor: "Lead Actor",
    allYears: "All Years",
    allGenres: "All Genres",
    allDirectors: "All Directors",
    allActors: "All Actors",
    resetFilters: "Reset Filters",
    totalMovies: "Total Movies",
    totalBoxOffice: "Total Box Office",
    avgRevenue: "Average Revenue",
    topGenre: "Top Genre",
    overview: "Overview",
    genreAnalysis: "Genre Analysis",
    directors: "Directors",
    timeline: "Timeline",
    movieGallery: "Movie Gallery",
    boxOfficeScatter: "Box Office Distribution",
    genreRevenue: "Revenue by Genre",
    topDirectors: "Top Directors by Revenue",
    boxOfficeTimeline: "Box Office Evolution",
    noData: "No data for the selected filters",
    totalRevenue: "Total Revenue",
    moviesInView: "Movies (in view)",
    movies: "Movies"
  },
  fr: {
    subtitle: "Découvrez les films les plus rentables",
    year: "Année",
    genre: "Genre",
    director: "Réalisateur",
    leadActor: "Acteur Principal",
    allYears: "Toutes les Années",
    allGenres: "Tous les Genres",
    allDirectors: "Tous les Réalisateurs",
    allActors: "Tous les Acteurs",
    resetFilters: "Réinitialiser",
    totalMovies: "Total de Films",
    totalBoxOffice: "Box Office Total",
    avgRevenue: "Revenu Moyen",
    topGenre: "Genre Principal",
    overview: "Aperçu",
    genreAnalysis: "Analyse par Genre",
    directors: "Réalisateurs",
    timeline: "Chronologie",
    movieGallery: "Galerie",
    boxOfficeScatter: "Distribution du Box Office",
    genreRevenue: "Revenus par Genre",
    topDirectors: "Meilleurs Réalisateurs",
    boxOfficeTimeline: "Évolution du Box Office",
    noData: "Aucune donnée pour les filtres sélectionnés",
    totalRevenue: "Revenu Total",
    moviesInView: "Films (en vue)",
    movies: "Films"
  }
};

const genreColors = {
  'Action': '#FF6B6B',
  'Animation': '#4ECDC4',
  'Fantasy': '#9B59B6',
  'Adventure': '#F39C12',
  'Science Fiction': '#3498DB',
  'Drama': '#E74C3C',
  'Comedy': '#FFD93D',
  'War': '#34495E'
};

function init() {
  populateFilters();
  applyFilters();
  window.addEventListener('resize', () => {
    if (currentTab === 'overview') drawMainChart();
    if (currentTab === 'genre') drawGenreChart();
    if (currentTab === 'director') drawDirectorChart();
    if (currentTab === 'timeline') drawTimelineChart();
    if (currentTab === 'gallery') drawMovieGallery();
  });
}

function setLanguage(lang) {
  currentLang = lang;
  document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  
  const t = translations[lang];
  document.querySelector('.subtitle').textContent = t.subtitle;
  
  document.querySelectorAll('label')[0].textContent = t.year;
  document.querySelectorAll('label')[1].textContent = t.genre;
  document.querySelectorAll('label')[2].textContent = t.director;
  document.querySelectorAll('label')[3].textContent = t.leadActor;
  
  document.querySelector('button').textContent = t.resetFilters;
  
  document.querySelectorAll('.stat-label')[0].textContent = t.totalMovies;
  document.querySelectorAll('.stat-label')[1].textContent = t.totalBoxOffice;
  document.querySelectorAll('.stat-label')[2].textContent = t.avgRevenue;
  document.querySelectorAll('.stat-label')[3].textContent = t.topGenre;
  
  document.querySelectorAll('.tab')[0].textContent = t.overview;
  document.querySelectorAll('.tab')[1].textContent = t.genreAnalysis;
  document.querySelectorAll('.tab')[2].textContent = t.directors;
  document.querySelectorAll('.tab')[3].textContent = t.timeline;
  document.querySelectorAll('.tab')[4].textContent = t.movieGallery;
  
  const vizTitles = document.querySelectorAll('.viz-title');
  vizTitles[0].textContent = t.boxOfficeScatter;
  vizTitles[1].textContent = t.genreRevenue;
  vizTitles[2].textContent = t.topDirectors;
  vizTitles[3].textContent = t.boxOfficeTimeline;
  vizTitles[4].textContent = t.movieGallery;
  
  populateFilters();
  updateStats();
  
  if (currentTab === 'overview') drawMainChart();
  if (currentTab === 'genre') drawGenreChart();
  if (currentTab === 'director') drawDirectorChart();
  if (currentTab === 'timeline') drawTimelineChart();
  if (currentTab === 'gallery') drawMovieGallery();
}

function populateFilters() {
  const t = translations[currentLang];
  const years = [...new Set(movieData.map(d => d.year))].sort((a,b)=>a-b);
  const genres = [...new Set(movieData.map(d => d.genre))].sort();
  const directors = [...new Set(movieData.map(d => d.director))].sort();
  const actors = [...new Set(movieData.map(d => d.actor || 'Unknown'))].sort();

  const yearSelect = document.getElementById('yearFilter');
  const currentYear = yearSelect.value;
  yearSelect.innerHTML = `<option value="all">${t.allYears}</option>`;
  years.forEach(y => {
    const opt = document.createElement('option');
    opt.value = y;
    opt.textContent = y;
    yearSelect.appendChild(opt);
  });
  yearSelect.value = currentYear;

  const genreSelect = document.getElementById('genreFilter');
  const currentGenre = genreSelect.value;
  genreSelect.innerHTML = `<option value="all">${t.allGenres}</option>`;
  genres.forEach(g => {
    const opt = document.createElement('option');
    opt.value = g;
    opt.textContent = g;
    genreSelect.appendChild(opt);
  });
  genreSelect.value = currentGenre;

  const directorSelect = document.getElementById('directorFilter');
  const currentDirector = directorSelect.value;
  directorSelect.innerHTML = `<option value="all">${t.allDirectors}</option>`;
  directors.forEach(d => {
    const opt = document.createElement('option');
    opt.value = d;
    opt.textContent = d;
    directorSelect.appendChild(opt);
  });
  directorSelect.value = currentDirector;

  const actorSelect = document.getElementById('actorFilter');
  const currentActor = actorSelect.value;
  actorSelect.innerHTML = `<option value="all">${t.allActors}</option>`;
  actors.forEach(a => {
    const opt = document.createElement('option');
    opt.value = a;
    opt.textContent = a;
    actorSelect.appendChild(opt);
  });
  actorSelect.value = currentActor;

  yearSelect.onchange = applyFilters;
  genreSelect.onchange = applyFilters;
  directorSelect.onchange = applyFilters;
  actorSelect.onchange = applyFilters;
}

function applyFilters() {
  const year = document.getElementById('yearFilter').value;
  const genre = document.getElementById('genreFilter').value;
  const director = document.getElementById('directorFilter').value;
  const actor = document.getElementById('actorFilter').value;

  filteredData = movieData.filter(d => {
    const actorVal = d.actor || 'Unknown';
    return (year === 'all' || d.year == year) &&
           (genre === 'all' || d.genre === genre) &&
           (director === 'all' || d.director === director) &&
           (actor === 'all' || actorVal === actor);
  });

  updateStats();
  
  if (currentTab === 'overview') drawMainChart();
  if (currentTab === 'genre') drawGenreChart();
  if (currentTab === 'director') drawDirectorChart();
  if (currentTab === 'timeline') drawTimelineChart();
  if (currentTab === 'gallery') drawMovieGallery();
}

function resetFilters() {
  document.getElementById('yearFilter').value = 'all';
  document.getElementById('genreFilter').value = 'all';
  document.getElementById('directorFilter').value = 'all';
  document.getElementById('actorFilter').value = 'all';
  applyFilters();
}

function updateStats() {
  const total = filteredData.length;
  const totalRevenue = d3.sum(filteredData, d => d.boxOffice);
  const avgRevenue = total > 0 ? (totalRevenue / total) : 0;
  
  const genreMap = d3.rollup(filteredData, v => v.length, d => d.genre);
  let topGenre = '-';
  if (genreMap.size > 0) {
    topGenre = Array.from(genreMap.entries()).sort((a,b)=>b[1]-a[1])[0][0];
  }

  document.getElementById('totalMovies').textContent = total;
  document.getElementById('totalBoxOffice').textContent = ' + (totalRevenue/1000).toFixed(1) + 'B';
  document.getElementById('avgRevenue').textContent = ' + avgRevenue.toFixed(1) + 'M';
  document.getElementById('topGenre').textContent = topGenre;
}

function drawMainChart() {
  const container = d3.select('#mainChart');
  container.selectAll('*').remove();
  const t = translations[currentLang];

  if (!filteredData.length) {
    container.append('p').style('padding','80px').style('text-align','center').style('color','#666').text(t.noData);
    return;
  }

  const margin = {top:40,right:60,bottom:60,left:80};
  const width = container.node().clientWidth - margin.left - margin.right;
  const height = 480 - margin.top - margin.bottom;

  const svg = container.append('svg')
    .attr('width', width + margin.left + margin.right)
    .attr('height', height + margin.top + margin.bottom)
    .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

  const x = d3.scaleLinear()
    .domain([d3.min(filteredData, d => d.year)-0.5, d3.max(filteredData, d => d.year)+0.5])
    .range([0, width]);

  const y = d3.scaleLinear()
    .domain([0, d3.max(filteredData, d => d.boxOffice) * 1.06])
    .range([height, 0]);

  svg.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-width).tickFormat(''));
  svg.append('g').attr('class','axis').attr('transform',`translate(0,${height})`).call(d3.axisBottom(x).ticks(Math.min(11,(d3.max(filteredData,d=>d.year)-d3.min(filteredData,d=>d.year))+1)).tickFormat(d3.format('d')));
  svg.append('g').attr('class','axis').call(d3.axisLeft(y).tickFormat(d => ' + d + 'M'));

  const tooltip = d3.select('#tooltip');
  const rScale = d3.scaleSqrt().domain([0, d3.max(filteredData, d=>d.boxOffice)]).range([5,20]);

  svg.selectAll('circle')
    .data(filteredData, d => d.title + d.year)
    .join('circle')
    .attr('cx', d => x(d.year))
    .attr('cy', d => y(d.boxOffice))
    .attr('r', 0)
    .attr('fill', d => genreColors[d.genre] || '#95a5a6')
    .attr('stroke', '#fff')
    .attr('stroke-width', 2)
    .attr('opacity', 0.85)
    .on('mouseover', function(event,d){
        d3.select(this).attr('stroke-width',3).attr('opacity',1.0).attr('r', rScale(d.boxOffice) + 3);
        tooltip.classed('active', true)
          .html(`<div class="tooltip-title">${d.title}</div>
                 <strong>${t.year}:</strong> ${d.year}<br>
                 <strong>${t.genre}:</strong> ${d.genre}<br>
                 <strong>Box Office:</strong> ${d.boxOffice.toFixed(1)}M<br>
                 <strong>${t.director}:</strong> ${d.director}<br>
                 <strong>${currentLang === 'en' ? 'Star' : 'Vedette'}:</strong> ${d.actor || 'N/A'}`)
          .style('left', (event.pageX + 12) + 'px')
          .style('top', (event.pageY - 12) + 'px');
    })
    .on('mousemove', function(event){
        tooltip.style('left', (event.pageX + 12) + 'px').style('top', (event.pageY - 12) + 'px');
    })
    .on('mouseout', function(event,d){
        d3.select(this).attr('stroke-width',2).attr('opacity',0.85).attr('r', rScale(d.boxOffice));
        tooltip.classed('active', false);
    })
    .transition().duration(700)
    .attr('r', d => rScale(d.boxOffice));
}

function drawGenreChart() {
  const container = d3.select('#genreChart');
  container.selectAll('*').remove();
  const t = translations[currentLang];

  if (!filteredData.length) {
    container.append('p').style('padding','80px').style('text-align','center').style('color','#666').text(t.noData);
    return;
  }

  const genreMap = d3.rollup(filteredData, v => d3.sum(v, d => d.boxOffice), d => d.genre);
  const genreData = Array.from(genreMap, ([genre, revenue]) => ({genre, revenue})).sort((a,b)=>b.revenue - a.revenue);

  const margin = {top:20,right:20,bottom:120,left:80};
  const width = container.node().clientWidth - margin.left - margin.right;
  const height = 480 - margin.top - margin.bottom;

  const svg = container.append('svg').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom)
    .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

  const x = d3.scaleBand().domain(genreData.map(d=>d.genre)).range([0,width]).padding(0.3);
  const y = d3.scaleLinear().domain([0, d3.max(genreData, d=>d.revenue) * 1.1]).range([height,0]);

  svg.append('g').attr('transform',`translate(0,${height})`).attr('class','axis')
    .call(d3.axisBottom(x)).selectAll('text').attr('transform','rotate(-45)').style('text-anchor','end');

  svg.append('g').attr('class','axis').call(d3.axisLeft(y).tickFormat(d => ' + d + 'M'));

  const tooltip = d3.select('#tooltip');

  svg.selectAll('rect')
    .data(genreData)
    .join('rect')
    .attr('x', d => x(d.genre))
    .attr('y', height)
    .attr('width', x.bandwidth())
    .attr('height', 0)
    .attr('fill', d => genreColors[d.genre] || '#95a5a6')
    .attr('opacity', 0.85)
    .attr('rx', 4)
    .on('mouseover', function(event,d){
      d3.select(this).attr('opacity',1);
      tooltip.classed('active', true)
        .html(`<div class="tooltip-title">${d.genre}</div>
               <strong>${t.totalRevenue}:</strong> ${d.revenue.toFixed(1)}M`);
      tooltip.style('left', (event.pageX + 12) + 'px').style('top', (event.pageY - 12) + 'px');
    })
    .on('mousemove', function(event){
      tooltip.style('left', (event.pageX + 12) + 'px').style('top', (event.pageY - 12) + 'px');
    })
    .on('mouseout', function(){
      d3.select(this).attr('opacity',0.85);
      tooltip.classed('active', false);
    })
    .transition().duration(700)
    .attr('y', d => y(d.revenue))
    .attr('height', d => height - y(d.revenue));
}

function drawDirectorChart() {
  const container = d3.select('#directorChart');
  container.selectAll('*').remove();
  const t = translations[currentLang];

  if (!filteredData.length) {
    container.append('p').style('padding','80px').style('text-align','center').style('color','#666').text(t.noData);
    return;
  }

  const directorMap = d3.rollup(filteredData, v => ({count: v.length, revenue: d3.sum(v, d=>d.boxOffice)}), d => d.director);
  const directorData = Array.from(directorMap, ([director,data]) => ({director, ...data})).sort((a,b)=>b.revenue - a.revenue).slice(0,10);

  const margin = {top:20,right:20,bottom:40,left:220};
  const width = container.node().clientWidth - margin.left - margin.right;
  const height = 480 - margin.top - margin.bottom;

  const svg = container.append('svg').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom)
    .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

  const x = d3.scaleLinear().domain([0, d3.max(directorData, d => d.revenue) * 1.05]).range([0, width]);
  const y = d3.scaleBand().domain(directorData.map(d => d.director)).range([0, height]).padding(0.2);

  svg.append('g').attr('class','axis').call(d3.axisLeft(y));
  svg.append('g').attr('class','axis').attr('transform',`translate(0,${height})`).call(d3.axisBottom(x).tickFormat(d=> ' + d + 'M'));

  const tooltip = d3.select('#tooltip');
  const colorScale = d3.scaleSequential(d3.interpolateViridis).domain([0, directorData.length - 1]);

  svg.selectAll('rect')
    .data(directorData)
    .join('rect')
    .attr('x', 0)
    .attr('y', d => y(d.director))
    .attr('height', y.bandwidth())
    .attr('width', 0)
    .attr('fill', (d, i) => colorScale(i))
    .attr('opacity', 0.85)
    .attr('rx', 4)
    .on('mouseover', function(event,d){
      d3.select(this).attr('opacity',1);
      tooltip.classed('active', true)
        .html(`<div class="tooltip-title">${d.director}</div>
               <strong>${t.moviesInView}:</strong> ${d.count}<br>
               <strong>${t.totalRevenue}:</strong> ${d.revenue.toFixed(1)}M`);
      tooltip.style('left', (event.pageX + 12) + 'px').style('top', (event.pageY - 12) + 'px');
    })
    .on('mousemove', function(event){
      tooltip.style('left', (event.pageX + 12) + 'px').style('top', (event.pageY - 12) + 'px');
    })
    .on('mouseout', function(){
      d3.select(this).attr('opacity',0.85);
      tooltip.classed('active', false);
    })
    .transition().duration(700)
    .attr('width', d => x(d.revenue));
}

function drawTimelineChart() {
  const container = d3.select('#timelineChart');
  container.selectAll('*').remove();
  const t = translations[currentLang];

  if (!filteredData.length) {
    container.append('p').style('padding','80px').style('text-align','center').style('color','#666').text(t.noData);
    return;
  }

  const yearMap = d3.rollup(filteredData, v => ({count: v.length, revenue: d3.sum(v, d => d.boxOffice)}), d => d.year);
  const yearData = Array.from(yearMap, ([year, data]) => ({year:+year, ...data})).sort((a,b)=>a.year - b.year);

  const margin = {top:40,right:60,bottom:60,left:80};
  const width = container.node().clientWidth - margin.left - margin.right;
  const height = 480 - margin.top - margin.bottom;

  const svg = container.append('svg').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom)
    .append('g').attr('transform', `translate(${margin.left},${margin.top})`);

  const x = d3.scaleLinear().domain(d3.extent(yearData, d => d.year)).range([0, width]);
  const y = d3.scaleLinear().domain([0, d3.max(yearData, d => d.revenue) * 1.06]).range([height, 0]);

  svg.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-width).tickFormat(''));
  svg.append('g').attr('class','axis').attr('transform',`translate(0,${height})`).call(d3.axisBottom(x).ticks(Math.min(11,yearData.length)).tickFormat(d3.format('d')));
  svg.append('g').attr('class','axis').call(d3.axisLeft(y).tickFormat(d => ' + d + 'M'));

  const gradient = svg.append('defs').append('linearGradient').attr('id','grad1').attr('x1','0%').attr('y1','0%').attr('x2','0%').attr('y2','100%');
  gradient.append('stop').attr('offset','0%').attr('stop-color','#3498DB').attr('stop-opacity',0.4);
  gradient.append('stop').attr('offset','100%').attr('stop-color','#3498DB').attr('stop-opacity',0);

  const area = d3.area()
    .x(d => x(d.year))
    .y0(height)
    .y1(d => y(d.revenue))
    .curve(d3.curveMonotoneX);

  svg.append('path').datum(yearData).attr('fill','url(#grad1)').attr('d', area);

  const line = d3.line().x(d => x(d.year)).y(d => y(d.revenue)).curve(d3.curveMonotoneX);
  svg.append('path').datum(yearData).attr('fill','none').attr('stroke','#3498DB').attr('stroke-width',3).attr('d', line);

  const tooltip = d3.select('#tooltip');

  svg.selectAll('circle')
    .data(yearData)
    .join('circle')
    .attr('cx', d => x(d.year))
    .attr('cy', d => y(d.revenue))
    .attr('r', 6)
    .attr('fill', '#3498DB')
    .attr('stroke', '#fff')
    .attr('stroke-width', 2)
    .on('mouseover', function(event,d){
      d3.select(this).attr('r',10);
      tooltip.classed('active', true)
        .html(`<div class="tooltip-title">${d.year}</div>
               <strong>${t.movies}:</strong> ${d.count}<br>
               <strong>${t.totalRevenue}:</strong> ${d.revenue.toFixed(1)}M`);
      tooltip.style('left', (event.pageX + 12) + 'px').style('top', (event.pageY - 12) + 'px');
    })
    .on('mousemove', function(event){
      tooltip.style('left', (event.pageX + 12) + 'px').style('top', (event.pageY - 12) + 'px');
    })
    .on('mouseout', function(){
      d3.select(this).attr('r',6);
      tooltip.classed('active', false);
    });
}

function drawMovieGallery() {
  const grid = d3.select('#movieGrid');
  grid.selectAll('*').remove();
  const t = translations[currentLang];

  if (!filteredData.length) {
    grid.append('p').style('padding','80px').style('text-align','center').style('color','#666').style('grid-column','1 / -1').text(t.noData);
    return;
  }

  const cards = grid.selectAll('.movie-card').data(filteredData, d => d.title).join('div').attr('class','movie-card');

  cards.append('img').attr('class','movie-poster')
    .attr('src', d => d.poster)
    .attr('alt', d => d.title)
    .attr('loading', 'lazy');

  const info = cards.append('div').attr('class','movie-info');

  info.append('div').attr('class','movie-title').text(d => d.title);
  info.append('div').attr('class','movie-details').html(d => `<strong>${d.year}</strong> • ${d.genre}<br>Box Office: <strong>${d.boxOffice.toFixed(1)}M</strong><br>${currentLang === 'en' ? 'Director' : 'Réalisateur'}: ${d.director}<br>${currentLang === 'en' ? 'Star' : 'Vedette'}: ${d.actor || 'N/A'}`);
}

function switchTab(event, tab) {
  currentTab = tab;
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');

  document.getElementById('overviewViz').style.display = 'none';
  document.getElementById('genreViz').style.display = 'none';
  document.getElementById('directorViz').style.display = 'none';
  document.getElementById('timelineViz').style.display = 'none';
  document.getElementById('galleryViz').style.display = 'none';

  if (tab === 'overview') {
    document.getElementById('overviewViz').style.display = 'block';
    drawMainChart();
  } else if (tab === 'genre') {
    document.getElementById('genreViz').style.display = 'block';
    drawGenreChart();
  } else if (tab === 'director') {
    document.getElementById('directorViz').style.display = 'block';
    drawDirectorChart();
  } else if (tab === 'timeline') {
    document.getElementById('timelineViz').style.display = 'block';
    drawTimelineChart();
  } else if (tab === 'gallery') {
    document.getElementById('galleryViz').style.display = 'block';
    drawMovieGallery();
  }
}

init();
</script>
</body>
</html>
